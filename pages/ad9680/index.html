<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Javaçº¿ç¨‹æ±  | JAVACORE</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/javacore/img/favicon.ico">
    <script src="https://cdn.wwads.cn/js/makemoney.js" type="text/javascript"></script>
    <meta name="description" content="â˜• JavaCore æ˜¯ä¸€ä¸ª Java æ ¸å¿ƒæŠ€æœ¯æ•™ç¨‹ã€‚">
    <meta name="keywords" content="vuepress,theme,blog,vdoing">
    <meta name="theme-color" content="#11a8cd">
    <meta name="wwads-cn-verify" content="mxqWx62nfQQ9ocT4e5DzISHzOWyF4s">
    
    <link rel="preload" href="/javacore/assets/css/0.styles.be3ea3bc.css" as="style"><link rel="preload" href="/javacore/assets/js/app.44fc03ae.js" as="script"><link rel="preload" href="/javacore/assets/js/2.aded268b.js" as="script"><link rel="preload" href="/javacore/assets/js/46.68ab70d3.js" as="script"><link rel="prefetch" href="/javacore/assets/js/10.b7bca9b5.js"><link rel="prefetch" href="/javacore/assets/js/11.033d3a41.js"><link rel="prefetch" href="/javacore/assets/js/12.b093ffe4.js"><link rel="prefetch" href="/javacore/assets/js/13.d561ca11.js"><link rel="prefetch" href="/javacore/assets/js/14.90010e0b.js"><link rel="prefetch" href="/javacore/assets/js/15.37509588.js"><link rel="prefetch" href="/javacore/assets/js/16.cd24ed18.js"><link rel="prefetch" href="/javacore/assets/js/17.5e555f8c.js"><link rel="prefetch" href="/javacore/assets/js/18.df926f74.js"><link rel="prefetch" href="/javacore/assets/js/19.8da3be6e.js"><link rel="prefetch" href="/javacore/assets/js/20.fb42e052.js"><link rel="prefetch" href="/javacore/assets/js/21.9d7decc0.js"><link rel="prefetch" href="/javacore/assets/js/22.f31ecff9.js"><link rel="prefetch" href="/javacore/assets/js/23.6f5cde97.js"><link rel="prefetch" href="/javacore/assets/js/24.e47f9024.js"><link rel="prefetch" href="/javacore/assets/js/25.da7e1173.js"><link rel="prefetch" href="/javacore/assets/js/26.e041331b.js"><link rel="prefetch" href="/javacore/assets/js/27.8f2ef716.js"><link rel="prefetch" href="/javacore/assets/js/28.a919e270.js"><link rel="prefetch" href="/javacore/assets/js/29.4846001f.js"><link rel="prefetch" href="/javacore/assets/js/3.d34c63b0.js"><link rel="prefetch" href="/javacore/assets/js/30.b3879734.js"><link rel="prefetch" href="/javacore/assets/js/31.e74cfb72.js"><link rel="prefetch" href="/javacore/assets/js/32.55bb9631.js"><link rel="prefetch" href="/javacore/assets/js/33.c695a6d1.js"><link rel="prefetch" href="/javacore/assets/js/34.146194b0.js"><link rel="prefetch" href="/javacore/assets/js/35.47c615d2.js"><link rel="prefetch" href="/javacore/assets/js/36.36c11b19.js"><link rel="prefetch" href="/javacore/assets/js/37.e4c911e1.js"><link rel="prefetch" href="/javacore/assets/js/38.612b0f0f.js"><link rel="prefetch" href="/javacore/assets/js/39.a8479ee6.js"><link rel="prefetch" href="/javacore/assets/js/4.884deeca.js"><link rel="prefetch" href="/javacore/assets/js/40.301701cc.js"><link rel="prefetch" href="/javacore/assets/js/41.7c62f68f.js"><link rel="prefetch" href="/javacore/assets/js/42.e9e5707c.js"><link rel="prefetch" href="/javacore/assets/js/43.2254ee61.js"><link rel="prefetch" href="/javacore/assets/js/44.24a7c914.js"><link rel="prefetch" href="/javacore/assets/js/45.4ed583ae.js"><link rel="prefetch" href="/javacore/assets/js/47.1716d6b6.js"><link rel="prefetch" href="/javacore/assets/js/48.8069bdf8.js"><link rel="prefetch" href="/javacore/assets/js/49.d272babd.js"><link rel="prefetch" href="/javacore/assets/js/5.0d7069e0.js"><link rel="prefetch" href="/javacore/assets/js/50.7fd74f29.js"><link rel="prefetch" href="/javacore/assets/js/51.f88d9d36.js"><link rel="prefetch" href="/javacore/assets/js/52.2adc8dae.js"><link rel="prefetch" href="/javacore/assets/js/53.e90f1fda.js"><link rel="prefetch" href="/javacore/assets/js/54.8616b845.js"><link rel="prefetch" href="/javacore/assets/js/55.1fabc8f2.js"><link rel="prefetch" href="/javacore/assets/js/56.e604e971.js"><link rel="prefetch" href="/javacore/assets/js/57.c4ac5a73.js"><link rel="prefetch" href="/javacore/assets/js/58.8e47e699.js"><link rel="prefetch" href="/javacore/assets/js/59.1c10231b.js"><link rel="prefetch" href="/javacore/assets/js/6.12339b00.js"><link rel="prefetch" href="/javacore/assets/js/60.bbcc0b2c.js"><link rel="prefetch" href="/javacore/assets/js/61.9d5ce6ce.js"><link rel="prefetch" href="/javacore/assets/js/62.db323fc4.js"><link rel="prefetch" href="/javacore/assets/js/63.ba26811b.js"><link rel="prefetch" href="/javacore/assets/js/64.b2257255.js"><link rel="prefetch" href="/javacore/assets/js/65.b3e77388.js"><link rel="prefetch" href="/javacore/assets/js/66.fbb8f12c.js"><link rel="prefetch" href="/javacore/assets/js/67.def25516.js"><link rel="prefetch" href="/javacore/assets/js/68.52669526.js"><link rel="prefetch" href="/javacore/assets/js/69.294be448.js"><link rel="prefetch" href="/javacore/assets/js/7.e7d8e450.js"><link rel="prefetch" href="/javacore/assets/js/70.8f9c4fe6.js"><link rel="prefetch" href="/javacore/assets/js/71.a20157d2.js"><link rel="prefetch" href="/javacore/assets/js/8.0ccc6dba.js"><link rel="prefetch" href="/javacore/assets/js/9.6cfc63c0.js">
    <link rel="stylesheet" href="/javacore/assets/css/0.styles.be3ea3bc.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="ç›®å½•" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/javacore/" class="home-link router-link-active"><img src="https://raw.githubusercontent.com/dunwu/images/master/common/dunwu-logo.png" alt="JAVACORE" class="logo"> <span class="site-name can-hide">JAVACORE</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/javacore/01.Java/01.JavaSE/01.åŸºç¡€ç‰¹æ€§/" class="nav-link">åŸºç¡€ç‰¹æ€§</a></div><div class="nav-item"><a href="/javacore/01.Java/01.JavaSE/02.é«˜çº§ç‰¹æ€§/" class="nav-link">é«˜çº§ç‰¹æ€§</a></div><div class="nav-item"><a href="/javacore/01.Java/01.JavaSE/03.å®¹å™¨/" class="nav-link">å®¹å™¨</a></div><div class="nav-item"><a href="/javacore/01.Java/01.JavaSE/04.IO/" class="nav-link">IO</a></div><div class="nav-item"><a href="/javacore/01.Java/01.JavaSE/05.å¹¶å‘/" class="nav-link">å¹¶å‘</a></div><div class="nav-item"><a href="/javacore/01.Java/01.JavaSE/06.JVM/" class="nav-link">JVM</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><!----> <span class="title" style="display:;">âœ¨ Javaç³»åˆ—</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://dunwu.github.io/java-tutorial/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Java æ•™ç¨‹ ğŸ“š
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://dunwu.github.io/javacore/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  JavaCore æ•™ç¨‹ ğŸ“š
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://dunwu.github.io/spring-tutorial/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Spring æ•™ç¨‹ ğŸ“š
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://dunwu.github.io/spring-boot-tutorial/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Spring Boot æ•™ç¨‹ ğŸ“š
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="https://github.com/dunwu/blog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ğŸ¯ åšå®¢
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/dunwu/javacore" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><!----> <nav class="nav-links"><div class="nav-item"><a href="/javacore/01.Java/01.JavaSE/01.åŸºç¡€ç‰¹æ€§/" class="nav-link">åŸºç¡€ç‰¹æ€§</a></div><div class="nav-item"><a href="/javacore/01.Java/01.JavaSE/02.é«˜çº§ç‰¹æ€§/" class="nav-link">é«˜çº§ç‰¹æ€§</a></div><div class="nav-item"><a href="/javacore/01.Java/01.JavaSE/03.å®¹å™¨/" class="nav-link">å®¹å™¨</a></div><div class="nav-item"><a href="/javacore/01.Java/01.JavaSE/04.IO/" class="nav-link">IO</a></div><div class="nav-item"><a href="/javacore/01.Java/01.JavaSE/05.å¹¶å‘/" class="nav-link">å¹¶å‘</a></div><div class="nav-item"><a href="/javacore/01.Java/01.JavaSE/06.JVM/" class="nav-link">JVM</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><!----> <span class="title" style="display:;">âœ¨ Javaç³»åˆ—</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://dunwu.github.io/java-tutorial/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Java æ•™ç¨‹ ğŸ“š
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://dunwu.github.io/javacore/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  JavaCore æ•™ç¨‹ ğŸ“š
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://dunwu.github.io/spring-tutorial/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Spring æ•™ç¨‹ ğŸ“š
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://dunwu.github.io/spring-boot-tutorial/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Spring Boot æ•™ç¨‹ ğŸ“š
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="https://github.com/dunwu/blog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ğŸ¯ åšå®¢
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/dunwu/javacore" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>JavaSE</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>åŸºç¡€ç‰¹æ€§</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>é«˜çº§ç‰¹æ€§</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>å®¹å™¨</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>IO</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>å¹¶å‘</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/javacore/pages/f6b642/" class="sidebar-link">Javaå¹¶å‘ç®€ä»‹</a></li><li><a href="/javacore/pages/fee2cc/" class="sidebar-link">Javaçº¿ç¨‹åŸºç¡€</a></li><li><a href="/javacore/pages/2c6488/" class="sidebar-link">Javaå¹¶å‘æ ¸å¿ƒæœºåˆ¶</a></li><li><a href="/javacore/pages/e2e047/" class="sidebar-link">Javaé”</a></li><li><a href="/javacore/pages/25f78a/" class="sidebar-link">JavaåŸå­ç±»</a></li><li><a href="/javacore/pages/b067d6/" class="sidebar-link">Javaå¹¶å‘å’Œå®¹å™¨</a></li><li><a href="/javacore/pages/ad9680/" aria-current="page" class="active sidebar-link">Javaçº¿ç¨‹æ± </a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/javacore/pages/ad9680/#ç®€ä»‹" class="sidebar-link">ç®€ä»‹</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/javacore/pages/ad9680/#ä»€ä¹ˆæ˜¯çº¿ç¨‹æ± " class="sidebar-link">ä»€ä¹ˆæ˜¯çº¿ç¨‹æ± </a></li><li class="sidebar-sub-header level3"><a href="/javacore/pages/ad9680/#ä¸ºä»€ä¹ˆè¦ç”¨çº¿ç¨‹æ± " class="sidebar-link">ä¸ºä»€ä¹ˆè¦ç”¨çº¿ç¨‹æ± </a></li></ul></li><li class="sidebar-sub-header level2"><a href="/javacore/pages/ad9680/#executor-æ¡†æ¶" class="sidebar-link">Executor æ¡†æ¶</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/javacore/pages/ad9680/#æ ¸å¿ƒ-api-æ¦‚è¿°" class="sidebar-link">æ ¸å¿ƒ API æ¦‚è¿°</a></li><li class="sidebar-sub-header level3"><a href="/javacore/pages/ad9680/#executor" class="sidebar-link">Executor</a></li><li class="sidebar-sub-header level3"><a href="/javacore/pages/ad9680/#executorservice" class="sidebar-link">ExecutorService</a></li><li class="sidebar-sub-header level3"><a href="/javacore/pages/ad9680/#scheduledexecutorservice" class="sidebar-link">ScheduledExecutorService</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/javacore/pages/ad9680/#threadpoolexecutor" class="sidebar-link">ThreadPoolExecutor</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/javacore/pages/ad9680/#é‡è¦å­—æ®µ" class="sidebar-link">é‡è¦å­—æ®µ</a></li><li class="sidebar-sub-header level3"><a href="/javacore/pages/ad9680/#æ„é€ æ–¹æ³•" class="sidebar-link">æ„é€ æ–¹æ³•</a></li><li class="sidebar-sub-header level3"><a href="/javacore/pages/ad9680/#execute-æ–¹æ³•" class="sidebar-link">execute æ–¹æ³•</a></li><li class="sidebar-sub-header level3"><a href="/javacore/pages/ad9680/#å…¶ä»–é‡è¦æ–¹æ³•" class="sidebar-link">å…¶ä»–é‡è¦æ–¹æ³•</a></li><li class="sidebar-sub-header level3"><a href="/javacore/pages/ad9680/#ä½¿ç”¨ç¤ºä¾‹" class="sidebar-link">ä½¿ç”¨ç¤ºä¾‹</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/javacore/pages/ad9680/#executors" class="sidebar-link">Executors</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/javacore/pages/ad9680/#newsinglethreadexecutor" class="sidebar-link">newSingleThreadExecutor</a></li><li class="sidebar-sub-header level3"><a href="/javacore/pages/ad9680/#newfixedthreadpool" class="sidebar-link">newFixedThreadPool</a></li><li class="sidebar-sub-header level3"><a href="/javacore/pages/ad9680/#newcachedthreadpool" class="sidebar-link">newCachedThreadPool</a></li><li class="sidebar-sub-header level3"><a href="/javacore/pages/ad9680/#newschedulethreadpool" class="sidebar-link">newScheduleThreadPool</a></li><li class="sidebar-sub-header level3"><a href="/javacore/pages/ad9680/#newworkstealingpool" class="sidebar-link">newWorkStealingPool</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/javacore/pages/ad9680/#çº¿ç¨‹æ± æœ€ä½³å®è·µ" class="sidebar-link">çº¿ç¨‹æ± æœ€ä½³å®è·µ</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/javacore/pages/ad9680/#è®¡ç®—çº¿ç¨‹æ•°é‡" class="sidebar-link">è®¡ç®—çº¿ç¨‹æ•°é‡</a></li><li class="sidebar-sub-header level3"><a href="/javacore/pages/ad9680/#å»ºè®®ä½¿ç”¨æœ‰ç•Œé˜»å¡é˜Ÿåˆ—" class="sidebar-link">å»ºè®®ä½¿ç”¨æœ‰ç•Œé˜»å¡é˜Ÿåˆ—</a></li><li class="sidebar-sub-header level3"><a href="/javacore/pages/ad9680/#é‡è¦ä»»åŠ¡åº”è¯¥è‡ªå®šä¹‰æ‹’ç»ç­–ç•¥" class="sidebar-link">é‡è¦ä»»åŠ¡åº”è¯¥è‡ªå®šä¹‰æ‹’ç»ç­–ç•¥</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/javacore/pages/ad9680/#å‚è€ƒèµ„æ–™" class="sidebar-link">å‚è€ƒèµ„æ–™</a></li></ul></li><li><a href="/javacore/pages/02d274/" class="sidebar-link">Javaå¹¶å‘å·¥å…·ç±»</a></li><li><a href="/javacore/pages/d4e06f/" class="sidebar-link">Javaå†…å­˜æ¨¡å‹</a></li><li><a href="/javacore/pages/edd121/" class="sidebar-link">ForkJoinæ¡†æ¶</a></li><li><a href="/javacore/pages/8655a7/" class="sidebar-link">Synchronized</a></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>JVM</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/javacore/pages/5f886e/" class="sidebar-link">Java é¢è¯•æ€»ç»“</a></li></ul></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/javacore/" title="é¦–é¡µ" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/javacore/categories/?category=Java" title="åˆ†ç±»" data-v-06225672>Java</a></li><li data-v-06225672><a href="/javacore/categories/?category=JavaSE" title="åˆ†ç±»" data-v-06225672>JavaSE</a></li><li data-v-06225672><a href="/javacore/categories/?category=%E5%B9%B6%E5%8F%91" title="åˆ†ç±»" data-v-06225672>å¹¶å‘</a></li></ul> <div class="info" data-v-06225672><div title="ä½œè€…" class="author iconfont icon-touxiang" data-v-06225672><a href="https://github.com/dunwu" target="_blank" title="ä½œè€…" class="beLink" data-v-06225672>dunwu</a></div> <div title="åˆ›å»ºæ—¶é—´" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2019-12-24</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">ç›®å½•</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABGpJREFUSA3tVVtoXFUU3fvOI53UlmCaKIFmwEhsE7QK0ipFEdHEKpXaZGrp15SINsXUWvBDpBgQRKi0+KKoFeJHfZA+ED9KKoIU2gYD9UejTW4rVIzm0VSTziPzuNu1z507dibTTjL4U/DAzLn3nL3X2o91ziX6f9wMFdh6Jvbm9nNSV0msViVO6tN1Rm7NMu2OpeJ9lWBUTDxrJbYTS0hInuwciu9eLHlFxCLCZEk3MegsJmZ5K/JD6t7FkFdEvGUo1g7qJoG3MHImqRIn8/nzY1K9UPKKiJmtnUqHVE3Gbuay6vJE/N2FEmuxFjW2nUuE0yQXRRxLiTUAzs36zhZvOXJPdX850EVnnLZkB8prodQoM5JGj7Xk2mvC7JB8tG04Ef5PiXtG0UtxupRQSfTnBoCy554x18yJHI6I+G5Eru4LHmPJZEQsrvPUbMiA8G/WgMK7w7I+ez7++o2ANfbrjvaOl1tFMs+htG3IrZH9/hDX1Pr8Tc0UvH8tcX29KzAgIGcEkINyW5BF9x891hw6VYqgJHEk0huccS7vh3C6gTiODL+26huuBtbct8eZnqLML8PkxGYpuPZBqtqwkSjgc4mB5gbgig5i+y0UDK35LMxXisn9xQtK+nd26gTIHsHe/oblK/b29fUmN/8Y+9jAQrnBp56m1LcDlDp9irKTExSKduXJVWSqdBMA08pEJnEIOB3FPPMybu/oeV8zFeYN3xx576Q6RH+VmplE4ncQV5v+5rzSoyOU7PuEAg8g803PwBJ0CExno/jcMbN8tONYeOmHiuUNryvm3fRUy4tMPVLdAGkUhNWuggGrJcXPv+ouCjz0MKUHz1J2/E8IC9nqTabcxgaBYM0hPhD5Y65FsbxRQKxCQrDjDctW7PUM3HuZunFyifSAqEfuzCp48Il24luWUWZoyJCaPR82jE0+kFA643wRFVni4RYSq3ohJO2pZ7B5dO4xkDWbEpossJPLSrPjYID8rS2UHTlvyNxqIGsg674XJJ7vnh5L7PNwC4hh2sjCI96mzszOTpxLF0T7l88Yz7lAuK6OnL8gXLOnTvpzSb22YG8W7us3jSebFHeeqnXRG1vt+MoUM84LQIBmMsCTAcOauTh0T0l0neQK7m2bLMt2mGxU3HYssS0J2cdv5wljlPsrIuZLAG/2DOZIXgCYT8uMGZN+e2kSirfxZOPCsC0f24nTZzspnVn9VePS1Z5vubmAGGXG8ZFno9Hel0yfA5ZPhF7Dh972BQJ2qCpgH67lmWtBYbvk6sz02wjky2vXyz0XErP/kFB619js1BtwfOV4OPRqOQBjy3Qbk18vigUPPSD5ceHnwck7W9bhAqZdd7SuG7w4/P2F/GaJh8c7e9qgow+Q7cGBo+98WsLkuktFqiZabtXuQTu/Y5ETbR0v7tNSFnvrmu6pjdoan2KjMu8q/Hmj1EfCO2ZGfEIbIXKUlw8qaX9/b2oeSJmFksSeT/Fn0V3nSypChh4Gjh74ybO9aeZ/AN2dwciu2/MhAAAAAElFTkSuQmCC">Javaçº¿ç¨‹æ± <!----></h1>  <div class="theme-vdoing-content content__default"><h1 id="java-çº¿ç¨‹æ± "><a href="#java-çº¿ç¨‹æ± " class="header-anchor">#</a> Java çº¿ç¨‹æ± </h1> <h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="header-anchor">#</a> ç®€ä»‹</h2> <h3 id="ä»€ä¹ˆæ˜¯çº¿ç¨‹æ± "><a href="#ä»€ä¹ˆæ˜¯çº¿ç¨‹æ± " class="header-anchor">#</a> ä»€ä¹ˆæ˜¯çº¿ç¨‹æ± </h3> <p>çº¿ç¨‹æ± æ˜¯ä¸€ç§å¤šçº¿ç¨‹å¤„ç†å½¢å¼ï¼Œå¤„ç†è¿‡ç¨‹ä¸­å°†ä»»åŠ¡æ·»åŠ åˆ°é˜Ÿåˆ—ï¼Œç„¶ååœ¨åˆ›å»ºçº¿ç¨‹åè‡ªåŠ¨å¯åŠ¨è¿™äº›ä»»åŠ¡ã€‚</p> <h3 id="ä¸ºä»€ä¹ˆè¦ç”¨çº¿ç¨‹æ± "><a href="#ä¸ºä»€ä¹ˆè¦ç”¨çº¿ç¨‹æ± " class="header-anchor">#</a> ä¸ºä»€ä¹ˆè¦ç”¨çº¿ç¨‹æ± </h3> <p>å¦‚æœå¹¶å‘è¯·æ±‚æ•°é‡å¾ˆå¤šï¼Œä½†æ¯ä¸ªçº¿ç¨‹æ‰§è¡Œçš„æ—¶é—´å¾ˆçŸ­ï¼Œå°±ä¼šå‡ºç°é¢‘ç¹çš„åˆ›å»ºå’Œé”€æ¯çº¿ç¨‹ã€‚å¦‚æ­¤ä¸€æ¥ï¼Œä¼šå¤§å¤§é™ä½ç³»ç»Ÿçš„æ•ˆç‡ï¼Œå¯èƒ½é¢‘ç¹åˆ›å»ºå’Œé”€æ¯çº¿ç¨‹çš„æ—¶é—´ã€èµ„æºå¼€é”€è¦å¤§äºå®é™…å·¥ä½œçš„æ‰€éœ€ã€‚</p> <p>æ­£æ˜¯ç”±äºè¿™ä¸ªé—®é¢˜ï¼Œæ‰€ä»¥æœ‰å¿…è¦å¼•å…¥çº¿ç¨‹æ± ã€‚ä½¿ç”¨ <strong>çº¿ç¨‹æ± çš„å¥½å¤„</strong> æœ‰ä»¥ä¸‹å‡ ç‚¹ï¼š</p> <ul><li><strong>é™ä½èµ„æºæ¶ˆè€—</strong> - é€šè¿‡é‡å¤åˆ©ç”¨å·²åˆ›å»ºçš„çº¿ç¨‹é™ä½çº¿ç¨‹åˆ›å»ºå’Œé”€æ¯é€ æˆçš„æ¶ˆè€—ã€‚</li> <li><strong>æé«˜å“åº”é€Ÿåº¦</strong> - å½“ä»»åŠ¡åˆ°è¾¾æ—¶ï¼Œä»»åŠ¡å¯ä»¥ä¸éœ€è¦ç­‰åˆ°çº¿ç¨‹åˆ›å»ºå°±èƒ½ç«‹å³æ‰§è¡Œã€‚</li> <li><strong>æé«˜çº¿ç¨‹çš„å¯ç®¡ç†æ€§</strong> - çº¿ç¨‹æ˜¯ç¨€ç¼ºèµ„æºï¼Œå¦‚æœæ— é™åˆ¶çš„åˆ›å»ºï¼Œä¸ä»…ä¼šæ¶ˆè€—ç³»ç»Ÿèµ„æºï¼Œè¿˜ä¼šé™ä½ç³»ç»Ÿçš„ç¨³å®šæ€§ï¼Œä½¿ç”¨çº¿ç¨‹æ± å¯ä»¥è¿›è¡Œç»Ÿä¸€çš„åˆ†é…ï¼Œè°ƒä¼˜å’Œç›‘æ§ã€‚ä½†æ˜¯è¦åšåˆ°åˆç†çš„åˆ©ç”¨çº¿ç¨‹æ± ï¼Œå¿…é¡»å¯¹å…¶åŸç†äº†å¦‚æŒ‡æŒã€‚</li></ul> <h2 id="executor-æ¡†æ¶"><a href="#executor-æ¡†æ¶" class="header-anchor">#</a> Executor æ¡†æ¶</h2> <blockquote><p>Executor æ¡†æ¶æ˜¯ä¸€ä¸ªæ ¹æ®ä¸€ç»„æ‰§è¡Œç­–ç•¥è°ƒç”¨ï¼Œè°ƒåº¦ï¼Œæ‰§è¡Œå’Œæ§åˆ¶çš„å¼‚æ­¥ä»»åŠ¡çš„æ¡†æ¶ï¼Œç›®çš„æ˜¯æä¾›ä¸€ç§å°†â€ä»»åŠ¡æäº¤â€ä¸â€ä»»åŠ¡å¦‚ä½•è¿è¡Œâ€åˆ†ç¦»å¼€æ¥çš„æœºåˆ¶ã€‚</p></blockquote> <h3 id="æ ¸å¿ƒ-api-æ¦‚è¿°"><a href="#æ ¸å¿ƒ-api-æ¦‚è¿°" class="header-anchor">#</a> æ ¸å¿ƒ API æ¦‚è¿°</h3> <p>Executor æ¡†æ¶æ ¸å¿ƒ API å¦‚ä¸‹ï¼š</p> <ul><li><code>Executor</code> - è¿è¡Œä»»åŠ¡çš„ç®€å•æ¥å£ã€‚</li> <li><code>ExecutorService</code> - æ‰©å±•äº† <code>Executor</code> æ¥å£ã€‚æ‰©å±•èƒ½åŠ›ï¼š
<ul><li>æ”¯æŒæœ‰è¿”å›å€¼çš„çº¿ç¨‹ï¼›</li> <li>æ”¯æŒç®¡ç†çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸã€‚</li></ul></li> <li><code>ScheduledExecutorService</code> - æ‰©å±•äº† <code>ExecutorService</code> æ¥å£ã€‚æ‰©å±•èƒ½åŠ›ï¼šæ”¯æŒå®šæœŸæ‰§è¡Œä»»åŠ¡ã€‚</li> <li><code>AbstractExecutorService</code> - <code>ExecutorService</code> æ¥å£çš„é»˜è®¤å®ç°ã€‚</li> <li><code>ThreadPoolExecutor</code> - Executor æ¡†æ¶æœ€æ ¸å¿ƒçš„ç±»ï¼Œå®ƒç»§æ‰¿äº† <code>AbstractExecutorService</code> ç±»ã€‚</li> <li><code>ScheduledThreadPoolExecutor</code> - <code>ScheduledExecutorService</code> æ¥å£çš„å®ç°ï¼Œä¸€ä¸ªå¯å®šæ—¶è°ƒåº¦ä»»åŠ¡çš„çº¿ç¨‹æ± ã€‚</li> <li><code>Executors</code> - å¯ä»¥é€šè¿‡è°ƒç”¨ <code>Executors</code> çš„é™æ€å·¥å‚æ–¹æ³•æ¥åˆ›å»ºçº¿ç¨‹æ± å¹¶è¿”å›ä¸€ä¸ª <code>ExecutorService</code> å¯¹è±¡ã€‚</li></ul> <p><img src="https://raw.githubusercontent.com/dunwu/images/master/cs/java/javacore/concurrent/exexctor-uml.png" alt="img"></p> <h3 id="executor"><a href="#executor" class="header-anchor">#</a> Executor</h3> <p><code>Executor</code> æ¥å£ä¸­åªå®šä¹‰äº†ä¸€ä¸ª <code>execute</code> æ–¹æ³•ï¼Œç”¨äºæ¥æ”¶ä¸€ä¸ª <code>Runnable</code> å¯¹è±¡ã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Executor</span> <span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token function">execute</span><span class="token punctuation">(</span><span class="token class-name">Runnable</span> command<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="executorservice"><a href="#executorservice" class="header-anchor">#</a> ExecutorService</h3> <p><code>ExecutorService</code> æ¥å£ç»§æ‰¿äº† <code>Executor</code> æ¥å£ï¼Œå®ƒè¿˜æä¾›äº† <code>invokeAll</code>ã€<code>invokeAny</code>ã€<code>shutdown</code>ã€<code>submit</code> ç­‰æ–¹æ³•ã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">ExecutorService</span> <span class="token keyword">extends</span> <span class="token class-name">Executor</span> <span class="token punctuation">{</span>

    <span class="token keyword">void</span> <span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Runnable</span><span class="token punctuation">&gt;</span></span> <span class="token function">shutdownNow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">boolean</span> <span class="token function">isShutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">boolean</span> <span class="token function">isTerminated</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">boolean</span> <span class="token function">awaitTermination</span><span class="token punctuation">(</span><span class="token keyword">long</span> timeout<span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span> unit<span class="token punctuation">)</span>
        <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span><span class="token punctuation">;</span>

    <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">Future</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token function">submit</span><span class="token punctuation">(</span><span class="token class-name">Callable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> task<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">Future</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token function">submit</span><span class="token punctuation">(</span><span class="token class-name">Runnable</span> task<span class="token punctuation">,</span> <span class="token class-name">T</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">Future</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> <span class="token function">submit</span><span class="token punctuation">(</span><span class="token class-name">Runnable</span> task<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Future</span><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">invokeAll</span><span class="token punctuation">(</span><span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">Callable</span><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> tasks<span class="token punctuation">)</span>
        <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span><span class="token punctuation">;</span>

    <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Future</span><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">invokeAll</span><span class="token punctuation">(</span><span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">Callable</span><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> tasks<span class="token punctuation">,</span>
                                  <span class="token keyword">long</span> timeout<span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span> unit<span class="token punctuation">)</span>
        <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span><span class="token punctuation">;</span>

    <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">T</span> <span class="token function">invokeAny</span><span class="token punctuation">(</span><span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">Callable</span><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> tasks<span class="token punctuation">)</span>
        <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span><span class="token punctuation">,</span> <span class="token class-name">ExecutionException</span><span class="token punctuation">;</span>

    <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">T</span> <span class="token function">invokeAny</span><span class="token punctuation">(</span><span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">Callable</span><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> tasks<span class="token punctuation">,</span>
                    <span class="token keyword">long</span> timeout<span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span> unit<span class="token punctuation">)</span>
        <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span><span class="token punctuation">,</span> <span class="token class-name">ExecutionException</span><span class="token punctuation">,</span> <span class="token class-name">TimeoutException</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ä»å…¶æ”¯æŒçš„æ–¹æ³•å®šä¹‰ï¼Œä¸éš¾çœ‹å‡ºï¼šç›¸æ¯”äº <code>Executor</code> æ¥å£ï¼Œ<code>ExecutorService</code> æ¥å£ä¸»è¦çš„æ‰©å±•æ˜¯ï¼š</p> <ul><li>æ”¯æŒæœ‰è¿”å›å€¼çš„çº¿ç¨‹ - <code>sumbit</code>ã€<code>invokeAll</code>ã€<code>invokeAny</code> æ–¹æ³•ä¸­éƒ½æ”¯æŒä¼ å…¥<code>Callable</code> å¯¹è±¡ã€‚</li> <li>æ”¯æŒç®¡ç†çº¿ç¨‹ç”Ÿå‘½å‘¨æœŸ - <code>shutdown</code>ã€<code>shutdownNow</code>ã€<code>isShutdown</code> ç­‰æ–¹æ³•ã€‚</li></ul> <h3 id="scheduledexecutorservice"><a href="#scheduledexecutorservice" class="header-anchor">#</a> ScheduledExecutorService</h3> <p><code>ScheduledExecutorService</code> æ¥å£æ‰©å±•äº† <code>ExecutorService</code> æ¥å£ã€‚</p> <p>å®ƒé™¤äº†æ”¯æŒå‰é¢ä¸¤ä¸ªæ¥å£çš„æ‰€æœ‰èƒ½åŠ›ä»¥å¤–ï¼Œè¿˜æ”¯æŒå®šæ—¶è°ƒåº¦çº¿ç¨‹ã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">ScheduledExecutorService</span> <span class="token keyword">extends</span> <span class="token class-name">ExecutorService</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token class-name">ScheduledFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> <span class="token function">schedule</span><span class="token punctuation">(</span><span class="token class-name">Runnable</span> command<span class="token punctuation">,</span>
                                       <span class="token keyword">long</span> delay<span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span> unit<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">ScheduledFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> <span class="token function">schedule</span><span class="token punctuation">(</span><span class="token class-name">Callable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> callable<span class="token punctuation">,</span>
                                           <span class="token keyword">long</span> delay<span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span> unit<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">ScheduledFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> <span class="token function">scheduleAtFixedRate</span><span class="token punctuation">(</span><span class="token class-name">Runnable</span> command<span class="token punctuation">,</span>
                                                  <span class="token keyword">long</span> initialDelay<span class="token punctuation">,</span>
                                                  <span class="token keyword">long</span> period<span class="token punctuation">,</span>
                                                  <span class="token class-name">TimeUnit</span> unit<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">ScheduledFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> <span class="token function">scheduleWithFixedDelay</span><span class="token punctuation">(</span><span class="token class-name">Runnable</span> command<span class="token punctuation">,</span>
                                                     <span class="token keyword">long</span> initialDelay<span class="token punctuation">,</span>
                                                     <span class="token keyword">long</span> delay<span class="token punctuation">,</span>
                                                     <span class="token class-name">TimeUnit</span> unit<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre></div><p>å…¶æ‰©å±•çš„æ¥å£æä¾›ä»¥ä¸‹èƒ½åŠ›ï¼š</p> <ul><li><code>schedule</code> æ–¹æ³•å¯ä»¥åœ¨æŒ‡å®šçš„å»¶æ—¶åæ‰§è¡Œä¸€ä¸ª <code>Runnable</code> æˆ–è€… <code>Callable</code> ä»»åŠ¡ã€‚</li> <li><code>scheduleAtFixedRate</code> æ–¹æ³•å’Œ <code>scheduleWithFixedDelay</code> æ–¹æ³•å¯ä»¥æŒ‰ç…§æŒ‡å®šæ—¶é—´é—´éš”ï¼Œå®šæœŸæ‰§è¡Œä»»åŠ¡ã€‚</li></ul> <h2 id="threadpoolexecutor"><a href="#threadpoolexecutor" class="header-anchor">#</a> ThreadPoolExecutor</h2> <p><code>java.uitl.concurrent.ThreadPoolExecutor</code> ç±»æ˜¯ <code>Executor</code> æ¡†æ¶ä¸­æœ€æ ¸å¿ƒçš„ç±»ã€‚æ‰€ä»¥ï¼Œæœ¬æ–‡å°†ç€é‡è®²è¿°ä¸€ä¸‹è¿™ä¸ªç±»ã€‚</p> <h3 id="é‡è¦å­—æ®µ"><a href="#é‡è¦å­—æ®µ" class="header-anchor">#</a> é‡è¦å­—æ®µ</h3> <p><code>ThreadPoolExecutor</code> æœ‰ä»¥ä¸‹é‡è¦å­—æ®µï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">AtomicInteger</span> ctl <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AtomicInteger</span><span class="token punctuation">(</span><span class="token function">ctlOf</span><span class="token punctuation">(</span><span class="token constant">RUNNING</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">COUNT_BITS</span> <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token constant">SIZE</span> <span class="token operator">-</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">CAPACITY</span>   <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token constant">COUNT_BITS</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token comment">// runState is stored in the high-order bits</span>
<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">RUNNING</span>    <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token constant">COUNT_BITS</span><span class="token punctuation">;</span>
<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">SHUTDOWN</span>   <span class="token operator">=</span>  <span class="token number">0</span> <span class="token operator">&lt;&lt;</span> <span class="token constant">COUNT_BITS</span><span class="token punctuation">;</span>
<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">STOP</span>       <span class="token operator">=</span>  <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token constant">COUNT_BITS</span><span class="token punctuation">;</span>
<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">TIDYING</span>    <span class="token operator">=</span>  <span class="token number">2</span> <span class="token operator">&lt;&lt;</span> <span class="token constant">COUNT_BITS</span><span class="token punctuation">;</span>
<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">TERMINATED</span> <span class="token operator">=</span>  <span class="token number">3</span> <span class="token operator">&lt;&lt;</span> <span class="token constant">COUNT_BITS</span><span class="token punctuation">;</span>
</code></pre></div><p>å‚æ•°è¯´æ˜ï¼š</p> <ul><li><code>ctl</code> - <strong>ç”¨äºæ§åˆ¶çº¿ç¨‹æ± çš„è¿è¡ŒçŠ¶æ€å’Œçº¿ç¨‹æ± ä¸­çš„æœ‰æ•ˆçº¿ç¨‹æ•°é‡</strong>ã€‚å®ƒåŒ…å«ä¸¤éƒ¨åˆ†çš„ä¿¡æ¯ï¼š
<ul><li>çº¿ç¨‹æ± çš„è¿è¡ŒçŠ¶æ€ (<code>runState</code>)</li> <li>çº¿ç¨‹æ± å†…æœ‰æ•ˆçº¿ç¨‹çš„æ•°é‡ (<code>workerCount</code>)</li> <li>å¯ä»¥çœ‹åˆ°ï¼Œ<code>ctl</code> ä½¿ç”¨äº† <code>Integer</code> ç±»å‹æ¥ä¿å­˜ï¼Œé«˜ 3 ä½ä¿å­˜ <code>runState</code>ï¼Œä½ 29 ä½ä¿å­˜ <code>workerCount</code>ã€‚<code>COUNT_BITS</code> å°±æ˜¯ 29ï¼Œ<code>CAPACITY</code> å°±æ˜¯ 1 å·¦ç§» 29 ä½å‡ 1ï¼ˆ29 ä¸ª 1ï¼‰ï¼Œè¿™ä¸ªå¸¸é‡è¡¨ç¤º <code>workerCount</code> çš„ä¸Šé™å€¼ï¼Œå¤§çº¦æ˜¯ 5 äº¿ã€‚</li></ul></li> <li>è¿è¡ŒçŠ¶æ€ - çº¿ç¨‹æ± ä¸€å…±æœ‰äº”ç§è¿è¡ŒçŠ¶æ€ï¼š
<ul><li><code>RUNNING</code> - <strong>è¿è¡ŒçŠ¶æ€</strong>ã€‚æ¥å—æ–°ä»»åŠ¡ï¼Œå¹¶ä¸”ä¹Ÿèƒ½å¤„ç†é˜»å¡é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ã€‚</li> <li><code>SHUTDOWN</code> - <strong>å…³é—­çŠ¶æ€</strong>ã€‚ä¸æ¥å—æ–°ä»»åŠ¡ï¼Œä½†å¯ä»¥å¤„ç†é˜»å¡é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ã€‚
<ul><li>åœ¨çº¿ç¨‹æ± å¤„äº <code>RUNNING</code> çŠ¶æ€æ—¶ï¼Œè°ƒç”¨ <code>shutdown</code> æ–¹æ³•ä¼šä½¿çº¿ç¨‹æ± è¿›å…¥åˆ°è¯¥çŠ¶æ€ã€‚</li> <li><code>finalize</code> æ–¹æ³•åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ä¹Ÿä¼šè°ƒç”¨ <code>shutdown</code> æ–¹æ³•è¿›å…¥è¯¥çŠ¶æ€ã€‚</li></ul></li> <li><code>STOP</code> - <strong>åœæ­¢çŠ¶æ€</strong>ã€‚ä¸æ¥å—æ–°ä»»åŠ¡ï¼Œä¹Ÿä¸å¤„ç†é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ã€‚ä¼šä¸­æ–­æ­£åœ¨å¤„ç†ä»»åŠ¡çš„çº¿ç¨‹ã€‚åœ¨çº¿ç¨‹æ± å¤„äº <code>RUNNING</code> æˆ– <code>SHUTDOWN</code> çŠ¶æ€æ—¶ï¼Œè°ƒç”¨ <code>shutdownNow</code> æ–¹æ³•ä¼šä½¿çº¿ç¨‹æ± è¿›å…¥åˆ°è¯¥çŠ¶æ€ã€‚</li> <li><code>TIDYING</code> - <strong>æ•´ç†çŠ¶æ€</strong>ã€‚å¦‚æœæ‰€æœ‰çš„ä»»åŠ¡éƒ½å·²ç»ˆæ­¢äº†ï¼Œ<code>workerCount</code> (æœ‰æ•ˆçº¿ç¨‹æ•°) ä¸º 0ï¼Œçº¿ç¨‹æ± è¿›å…¥è¯¥çŠ¶æ€åä¼šè°ƒç”¨ <code>terminated</code> æ–¹æ³•è¿›å…¥ <code>TERMINATED</code> çŠ¶æ€ã€‚</li> <li><code>TERMINATED</code> - <strong>å·²ç»ˆæ­¢çŠ¶æ€</strong>ã€‚åœ¨ <code>terminated</code> æ–¹æ³•æ‰§è¡Œå®Œåè¿›å…¥è¯¥çŠ¶æ€ã€‚é»˜è®¤ <code>terminated</code> æ–¹æ³•ä¸­ä»€ä¹ˆä¹Ÿæ²¡æœ‰åšã€‚è¿›å…¥ <code>TERMINATED</code> çš„æ¡ä»¶å¦‚ä¸‹ï¼š
<ul><li>çº¿ç¨‹æ± ä¸æ˜¯ <code>RUNNING</code> çŠ¶æ€ï¼›</li> <li>çº¿ç¨‹æ± çŠ¶æ€ä¸æ˜¯ <code>TIDYING</code> çŠ¶æ€æˆ– <code>TERMINATED</code> çŠ¶æ€ï¼›</li> <li>å¦‚æœçº¿ç¨‹æ± çŠ¶æ€æ˜¯ <code>SHUTDOWN</code> å¹¶ä¸” <code>workerQueue</code> ä¸ºç©ºï¼›</li> <li><code>workerCount</code> ä¸º 0ï¼›</li> <li>è®¾ç½® <code>TIDYING</code> çŠ¶æ€æˆåŠŸã€‚</li></ul></li></ul></li></ul> <p><img src="https://raw.githubusercontent.com/dunwu/images/master/cs/java/javacore/concurrent/java-thread-pool_2.png" alt="img"></p> <h3 id="æ„é€ æ–¹æ³•"><a href="#æ„é€ æ–¹æ³•" class="header-anchor">#</a> æ„é€ æ–¹æ³•</h3> <p><code>ThreadPoolExecutor</code> æœ‰å››ä¸ªæ„é€ æ–¹æ³•ï¼Œå‰ä¸‰ä¸ªéƒ½æ˜¯åŸºäºç¬¬å››ä¸ªå®ç°ã€‚ç¬¬å››ä¸ªæ„é€ æ–¹æ³•å®šä¹‰å¦‚ä¸‹ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">(</span><span class="token keyword">int</span> corePoolSize<span class="token punctuation">,</span>
                              <span class="token keyword">int</span> maximumPoolSize<span class="token punctuation">,</span>
                              <span class="token keyword">long</span> keepAliveTime<span class="token punctuation">,</span>
                              <span class="token class-name">TimeUnit</span> unit<span class="token punctuation">,</span>
                              <span class="token class-name">BlockingQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Runnable</span><span class="token punctuation">&gt;</span></span> workQueue<span class="token punctuation">,</span>
                              <span class="token class-name">ThreadFactory</span> threadFactory<span class="token punctuation">,</span>
                              <span class="token class-name">RejectedExecutionHandler</span> handler<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</code></pre></div><p>å‚æ•°è¯´æ˜ï¼š</p> <ul><li><code>corePoolSize</code> - <strong>æ ¸å¿ƒçº¿ç¨‹æ•°é‡</strong>ã€‚å½“æœ‰æ–°ä»»åŠ¡é€šè¿‡ <code>execute</code> æ–¹æ³•æäº¤æ—¶ ï¼Œçº¿ç¨‹æ± ä¼šæ‰§è¡Œä»¥ä¸‹åˆ¤æ–­ï¼š
<ul><li>å¦‚æœè¿è¡Œçš„çº¿ç¨‹æ•°å°‘äº <code>corePoolSize</code>ï¼Œåˆ™åˆ›å»ºæ–°çº¿ç¨‹æ¥å¤„ç†ä»»åŠ¡ï¼Œå³ä½¿çº¿ç¨‹æ± ä¸­çš„å…¶ä»–çº¿ç¨‹æ˜¯ç©ºé—²çš„ã€‚</li> <li>å¦‚æœçº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°é‡å¤§äºç­‰äº <code>corePoolSize</code> ä¸”å°äº <code>maximumPoolSize</code>ï¼Œåˆ™åªæœ‰å½“ <code>workQueue</code> æ»¡æ—¶æ‰åˆ›å»ºæ–°çš„çº¿ç¨‹å»å¤„ç†ä»»åŠ¡ï¼›</li> <li>å¦‚æœè®¾ç½®çš„ <code>corePoolSize</code> å’Œ <code>maximumPoolSize</code> ç›¸åŒï¼Œåˆ™åˆ›å»ºçš„çº¿ç¨‹æ± çš„å¤§å°æ˜¯å›ºå®šçš„ã€‚è¿™æ—¶å¦‚æœæœ‰æ–°ä»»åŠ¡æäº¤ï¼Œè‹¥ <code>workQueue</code> æœªæ»¡ï¼Œåˆ™å°†è¯·æ±‚æ”¾å…¥ <code>workQueue</code> ä¸­ï¼Œç­‰å¾…æœ‰ç©ºé—²çš„çº¿ç¨‹å»ä» <code>workQueue</code> ä¸­å–ä»»åŠ¡å¹¶å¤„ç†ï¼›</li> <li>å¦‚æœè¿è¡Œçš„çº¿ç¨‹æ•°é‡å¤§äºç­‰äº <code>maximumPoolSize</code>ï¼Œè¿™æ—¶å¦‚æœ <code>workQueue</code> å·²ç»æ»¡äº†ï¼Œåˆ™ä½¿ç”¨ <code>handler</code> æ‰€æŒ‡å®šçš„ç­–ç•¥æ¥å¤„ç†ä»»åŠ¡ï¼›</li> <li>æ‰€ä»¥ï¼Œä»»åŠ¡æäº¤æ—¶ï¼Œåˆ¤æ–­çš„é¡ºåºä¸º <code>corePoolSize</code> =&gt; <code>workQueue</code> =&gt; <code>maximumPoolSize</code>ã€‚</li></ul></li> <li><code>maximumPoolSize</code> - <strong>æœ€å¤§çº¿ç¨‹æ•°é‡</strong>ã€‚
<ul><li>å¦‚æœé˜Ÿåˆ—æ»¡äº†ï¼Œå¹¶ä¸”å·²åˆ›å»ºçš„çº¿ç¨‹æ•°å°äºæœ€å¤§çº¿ç¨‹æ•°ï¼Œåˆ™çº¿ç¨‹æ± ä¼šå†åˆ›å»ºæ–°çš„çº¿ç¨‹æ‰§è¡Œä»»åŠ¡ã€‚</li> <li>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼šå¦‚æœä½¿ç”¨äº†æ— ç•Œçš„ä»»åŠ¡é˜Ÿåˆ—è¿™ä¸ªå‚æ•°å°±æ²¡ä»€ä¹ˆæ•ˆæœã€‚</li></ul></li> <li><code>keepAliveTime</code>ï¼š<strong>çº¿ç¨‹ä¿æŒæ´»åŠ¨çš„æ—¶é—´</strong>ã€‚
<ul><li>å½“çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°é‡å¤§äº <code>corePoolSize</code> çš„æ—¶å€™ï¼Œå¦‚æœè¿™æ—¶æ²¡æœ‰æ–°çš„ä»»åŠ¡æäº¤ï¼Œæ ¸å¿ƒçº¿ç¨‹å¤–çš„çº¿ç¨‹ä¸ä¼šç«‹å³é”€æ¯ï¼Œè€Œæ˜¯ä¼šç­‰å¾…ï¼Œç›´åˆ°ç­‰å¾…çš„æ—¶é—´è¶…è¿‡äº† <code>keepAliveTime</code>ã€‚</li> <li>æ‰€ä»¥ï¼Œå¦‚æœä»»åŠ¡å¾ˆå¤šï¼Œå¹¶ä¸”æ¯ä¸ªä»»åŠ¡æ‰§è¡Œçš„æ—¶é—´æ¯”è¾ƒçŸ­ï¼Œå¯ä»¥è°ƒå¤§è¿™ä¸ªæ—¶é—´ï¼Œæé«˜çº¿ç¨‹çš„åˆ©ç”¨ç‡ã€‚</li></ul></li> <li><code>unit</code> - <strong><code>keepAliveTime</code> çš„æ—¶é—´å•ä½</strong>ã€‚æœ‰ 7 ç§å–å€¼ã€‚å¯é€‰çš„å•ä½æœ‰å¤©ï¼ˆDAYSï¼‰ï¼Œå°æ—¶ï¼ˆHOURSï¼‰ï¼Œåˆ†é’Ÿï¼ˆMINUTESï¼‰ï¼Œæ¯«ç§’(MILLISECONDS)ï¼Œå¾®ç§’(MICROSECONDS, åƒåˆ†ä¹‹ä¸€æ¯«ç§’)å’Œæ¯«å¾®ç§’(NANOSECONDS, åƒåˆ†ä¹‹ä¸€å¾®ç§’)ã€‚</li> <li><code>workQueue</code> - <strong>ç­‰å¾…æ‰§è¡Œçš„ä»»åŠ¡é˜Ÿåˆ—</strong>ã€‚ç”¨äºä¿å­˜ç­‰å¾…æ‰§è¡Œçš„ä»»åŠ¡çš„é˜»å¡é˜Ÿåˆ—ã€‚ å¯ä»¥é€‰æ‹©ä»¥ä¸‹å‡ ä¸ªé˜»å¡é˜Ÿåˆ—ã€‚
<ul><li><code>ArrayBlockingQueue</code> - <strong>æœ‰ç•Œé˜»å¡é˜Ÿåˆ—</strong>ã€‚
<ul><li>æ­¤é˜Ÿåˆ—æ˜¯<strong>åŸºäºæ•°ç»„çš„å…ˆè¿›å…ˆå‡ºé˜Ÿåˆ—ï¼ˆFIFOï¼‰</strong>ã€‚</li> <li>æ­¤é˜Ÿåˆ—åˆ›å»ºæ—¶å¿…é¡»æŒ‡å®šå¤§å°ã€‚</li></ul></li> <li><code>LinkedBlockingQueue</code> - <strong>æ— ç•Œé˜»å¡é˜Ÿåˆ—</strong>ã€‚
<ul><li>æ­¤é˜Ÿåˆ—æ˜¯<strong>åŸºäºé“¾è¡¨çš„å…ˆè¿›å…ˆå‡ºé˜Ÿåˆ—ï¼ˆFIFOï¼‰</strong>ã€‚</li> <li>å¦‚æœåˆ›å»ºæ—¶æ²¡æœ‰æŒ‡å®šæ­¤é˜Ÿåˆ—å¤§å°ï¼Œåˆ™é»˜è®¤ä¸º <code>Integer.MAX_VALUE</code>ã€‚</li> <li>ååé‡é€šå¸¸è¦é«˜äº <code>ArrayBlockingQueue</code>ã€‚</li> <li>ä½¿ç”¨ <code>LinkedBlockingQueue</code> æ„å‘³ç€ï¼š <code>maximumPoolSize</code> å°†ä¸èµ·ä½œç”¨ï¼Œçº¿ç¨‹æ± èƒ½åˆ›å»ºçš„æœ€å¤§çº¿ç¨‹æ•°ä¸º <code>corePoolSize</code>ï¼Œå› ä¸ºä»»åŠ¡ç­‰å¾…é˜Ÿåˆ—æ˜¯æ— ç•Œé˜Ÿåˆ—ã€‚</li> <li><code>Executors.newFixedThreadPool</code> ä½¿ç”¨äº†è¿™ä¸ªé˜Ÿåˆ—ã€‚</li></ul></li> <li><code>SynchronousQueue</code> - <strong>ä¸ä¼šä¿å­˜æäº¤çš„ä»»åŠ¡ï¼Œè€Œæ˜¯å°†ç›´æ¥æ–°å»ºä¸€ä¸ªçº¿ç¨‹æ¥æ‰§è¡Œæ–°æ¥çš„ä»»åŠ¡</strong>ã€‚
<ul><li>æ¯ä¸ªæ’å…¥æ“ä½œå¿…é¡»ç­‰åˆ°å¦ä¸€ä¸ªçº¿ç¨‹è°ƒç”¨ç§»é™¤æ“ä½œï¼Œå¦åˆ™æ’å…¥æ“ä½œä¸€ç›´å¤„äºé˜»å¡çŠ¶æ€ã€‚</li> <li>ååé‡é€šå¸¸è¦é«˜äº <code>LinkedBlockingQueue</code>ã€‚</li> <li><code>Executors.newCachedThreadPool</code> ä½¿ç”¨äº†è¿™ä¸ªé˜Ÿåˆ—ã€‚</li></ul></li> <li><code>PriorityBlockingQueue</code> - <strong>å…·æœ‰ä¼˜å…ˆçº§çš„æ— ç•Œé˜»å¡é˜Ÿåˆ—</strong>ã€‚</li></ul></li> <li><code>threadFactory</code> - <strong>çº¿ç¨‹å·¥å‚</strong>ã€‚å¯ä»¥é€šè¿‡çº¿ç¨‹å·¥å‚ç»™æ¯ä¸ªåˆ›å»ºå‡ºæ¥çš„çº¿ç¨‹è®¾ç½®æ›´æœ‰æ„ä¹‰çš„åå­—ã€‚</li> <li><code>handler</code> - <strong>é¥±å’Œç­–ç•¥</strong>ã€‚å®ƒæ˜¯ <code>RejectedExecutionHandler</code> ç±»å‹çš„å˜é‡ã€‚å½“é˜Ÿåˆ—å’Œçº¿ç¨‹æ± éƒ½æ»¡äº†ï¼Œè¯´æ˜çº¿ç¨‹æ± å¤„äºé¥±å’ŒçŠ¶æ€ï¼Œé‚£ä¹ˆå¿…é¡»é‡‡å–ä¸€ç§ç­–ç•¥å¤„ç†æäº¤çš„æ–°ä»»åŠ¡ã€‚çº¿ç¨‹æ± æ”¯æŒä»¥ä¸‹ç­–ç•¥ï¼š
<ul><li><code>AbortPolicy</code> - ä¸¢å¼ƒä»»åŠ¡å¹¶æŠ›å‡ºå¼‚å¸¸ã€‚è¿™ä¹Ÿæ˜¯é»˜è®¤ç­–ç•¥ã€‚</li> <li><code>DiscardPolicy</code> - ä¸¢å¼ƒä»»åŠ¡ï¼Œä½†ä¸æŠ›å‡ºå¼‚å¸¸ã€‚</li> <li><code>DiscardOldestPolicy</code> - ä¸¢å¼ƒé˜Ÿåˆ—æœ€å‰é¢çš„ä»»åŠ¡ï¼Œç„¶åé‡æ–°å°è¯•æ‰§è¡Œä»»åŠ¡ï¼ˆé‡å¤æ­¤è¿‡ç¨‹ï¼‰ã€‚</li> <li><code>CallerRunsPolicy</code> - ç›´æ¥è°ƒç”¨ <code>run</code> æ–¹æ³•å¹¶ä¸”é˜»å¡æ‰§è¡Œã€‚</li> <li>å¦‚æœä»¥ä¸Šç­–ç•¥éƒ½ä¸èƒ½æ»¡è¶³éœ€è¦ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å®ç° <code>RejectedExecutionHandler</code> æ¥å£æ¥å®šåˆ¶å¤„ç†ç­–ç•¥ã€‚å¦‚è®°å½•æ—¥å¿—æˆ–æŒä¹…åŒ–ä¸èƒ½å¤„ç†çš„ä»»åŠ¡ã€‚</li></ul></li></ul> <h3 id="execute-æ–¹æ³•"><a href="#execute-æ–¹æ³•" class="header-anchor">#</a> execute æ–¹æ³•</h3> <p>é»˜è®¤æƒ…å†µä¸‹ï¼Œåˆ›å»ºçº¿ç¨‹æ± ä¹‹åï¼Œçº¿ç¨‹æ± ä¸­æ˜¯æ²¡æœ‰çº¿ç¨‹çš„ï¼Œéœ€è¦æäº¤ä»»åŠ¡ä¹‹åæ‰ä¼šåˆ›å»ºçº¿ç¨‹ã€‚</p> <p>æäº¤ä»»åŠ¡å¯ä»¥ä½¿ç”¨ <code>execute</code> æ–¹æ³•ï¼Œå®ƒæ˜¯ <code>ThreadPoolExecutor</code> çš„æ ¸å¿ƒæ–¹æ³•ï¼Œé€šè¿‡è¿™ä¸ªæ–¹æ³•å¯ä»¥<strong>å‘çº¿ç¨‹æ± æäº¤ä¸€ä¸ªä»»åŠ¡ï¼Œäº¤ç”±çº¿ç¨‹æ± å»æ‰§è¡Œ</strong>ã€‚</p> <p><code>execute</code> æ–¹æ³•å·¥ä½œæµç¨‹å¦‚ä¸‹ï¼š</p> <ol><li>å¦‚æœ <code>workerCount &lt; corePoolSize</code>ï¼Œåˆ™åˆ›å»ºå¹¶å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹æ¥æ‰§è¡Œæ–°æäº¤çš„ä»»åŠ¡ï¼›</li> <li>å¦‚æœ <code>workerCount &gt;= corePoolSize</code>ï¼Œä¸”çº¿ç¨‹æ± å†…çš„é˜»å¡é˜Ÿåˆ—æœªæ»¡ï¼Œåˆ™å°†ä»»åŠ¡æ·»åŠ åˆ°è¯¥é˜»å¡é˜Ÿåˆ—ä¸­ï¼›</li> <li>å¦‚æœ <code>workerCount &gt;= corePoolSize &amp;&amp; workerCount &lt; maximumPoolSize</code>ï¼Œä¸”çº¿ç¨‹æ± å†…çš„é˜»å¡é˜Ÿåˆ—å·²æ»¡ï¼Œåˆ™åˆ›å»ºå¹¶å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹æ¥æ‰§è¡Œæ–°æäº¤çš„ä»»åŠ¡ï¼›</li> <li>å¦‚æœ<code>workerCount &gt;= maximumPoolSize</code>ï¼Œå¹¶ä¸”çº¿ç¨‹æ± å†…çš„é˜»å¡é˜Ÿåˆ—å·²æ»¡ï¼Œåˆ™æ ¹æ®æ‹’ç»ç­–ç•¥æ¥å¤„ç†è¯¥ä»»åŠ¡, é»˜è®¤çš„å¤„ç†æ–¹å¼æ˜¯ç›´æ¥æŠ›å¼‚å¸¸ã€‚</li></ol> <p><img src="https://raw.githubusercontent.com/dunwu/images/master/cs/java/javacore/concurrent/java-thread-pool_1.png" alt="img"></p> <h3 id="å…¶ä»–é‡è¦æ–¹æ³•"><a href="#å…¶ä»–é‡è¦æ–¹æ³•" class="header-anchor">#</a> å…¶ä»–é‡è¦æ–¹æ³•</h3> <p>åœ¨ <code>ThreadPoolExecutor</code> ç±»ä¸­è¿˜æœ‰ä¸€äº›é‡è¦çš„æ–¹æ³•ï¼š</p> <ul><li><code>submit</code> - ç±»ä¼¼äº <code>execute</code>ï¼Œä½†æ˜¯é’ˆå¯¹çš„æ˜¯æœ‰è¿”å›å€¼çš„çº¿ç¨‹ã€‚<code>submit</code> æ–¹æ³•æ˜¯åœ¨ <code>ExecutorService</code> ä¸­å£°æ˜çš„æ–¹æ³•ï¼Œåœ¨ <code>AbstractExecutorService</code> å°±å·²ç»æœ‰äº†å…·ä½“çš„å®ç°ã€‚<code>ThreadPoolExecutor</code> ç›´æ¥å¤ç”¨ <code>AbstractExecutorService</code> çš„ <code>submit</code> æ–¹æ³•ã€‚</li> <li><code>shutdown</code> - ä¸ä¼šç«‹å³ç»ˆæ­¢çº¿ç¨‹æ± ï¼Œè€Œæ˜¯è¦ç­‰æ‰€æœ‰ä»»åŠ¡ç¼“å­˜é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡éƒ½æ‰§è¡Œå®Œåæ‰ç»ˆæ­¢ï¼Œä½†å†ä¹Ÿä¸ä¼šæ¥å—æ–°çš„ä»»åŠ¡ã€‚
<ul><li>å°†çº¿ç¨‹æ± åˆ‡æ¢åˆ° <code>SHUTDOWN</code> çŠ¶æ€ï¼›</li> <li>å¹¶è°ƒç”¨ <code>interruptIdleWorkers</code> æ–¹æ³•è¯·æ±‚ä¸­æ–­æ‰€æœ‰ç©ºé—²çš„ workerï¼›</li> <li>æœ€åè°ƒç”¨ <code>tryTerminate</code> å°è¯•ç»“æŸçº¿ç¨‹æ± ã€‚</li></ul></li> <li><code>shutdownNow</code> - ç«‹å³ç»ˆæ­¢çº¿ç¨‹æ± ï¼Œå¹¶å°è¯•æ‰“æ–­æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡ï¼Œå¹¶ä¸”æ¸…ç©ºä»»åŠ¡ç¼“å­˜é˜Ÿåˆ—ï¼Œè¿”å›å°šæœªæ‰§è¡Œçš„ä»»åŠ¡ã€‚ä¸ <code>shutdown</code> æ–¹æ³•ç±»ä¼¼ï¼Œä¸åŒçš„åœ°æ–¹åœ¨äºï¼š
<ul><li>è®¾ç½®çŠ¶æ€ä¸º <code>STOP</code>ï¼›</li> <li>ä¸­æ–­æ‰€æœ‰å·¥ä½œçº¿ç¨‹ï¼Œæ— è®ºæ˜¯å¦æ˜¯ç©ºé—²çš„ï¼›</li> <li>å–å‡ºé˜»å¡é˜Ÿåˆ—ä¸­æ²¡æœ‰è¢«æ‰§è¡Œçš„ä»»åŠ¡å¹¶è¿”å›ã€‚</li></ul></li> <li><code>isShutdown</code> - è°ƒç”¨äº† <code>shutdown</code> æˆ– <code>shutdownNow</code> æ–¹æ³•åï¼Œ<code>isShutdown</code> æ–¹æ³•å°±ä¼šè¿”å› trueã€‚</li> <li><code>isTerminaed</code> - å½“æ‰€æœ‰çš„ä»»åŠ¡éƒ½å·²å…³é—­åï¼Œæ‰è¡¨ç¤ºçº¿ç¨‹æ± å…³é—­æˆåŠŸï¼Œè¿™æ—¶è°ƒç”¨ <code>isTerminaed</code> æ–¹æ³•ä¼šè¿”å› trueã€‚</li> <li><code>setCorePoolSize</code> - è®¾ç½®æ ¸å¿ƒçº¿ç¨‹æ•°å¤§å°ã€‚</li> <li><code>setMaximumPoolSize</code> - è®¾ç½®æœ€å¤§çº¿ç¨‹æ•°å¤§å°ã€‚</li> <li><code>getTaskCount</code> - çº¿ç¨‹æ± å·²ç»æ‰§è¡Œçš„å’Œæœªæ‰§è¡Œçš„ä»»åŠ¡æ€»æ•°ï¼›</li> <li><code>getCompletedTaskCount</code> - çº¿ç¨‹æ± å·²å®Œæˆçš„ä»»åŠ¡æ•°é‡ï¼Œè¯¥å€¼å°äºç­‰äº <code>taskCount</code>ï¼›</li> <li><code>getLargestPoolSize</code> - çº¿ç¨‹æ± æ›¾ç»åˆ›å»ºè¿‡çš„æœ€å¤§çº¿ç¨‹æ•°é‡ã€‚é€šè¿‡è¿™ä¸ªæ•°æ®å¯ä»¥çŸ¥é“çº¿ç¨‹æ± æ˜¯å¦æ»¡è¿‡ï¼Œä¹Ÿå°±æ˜¯è¾¾åˆ°äº† <code>maximumPoolSize</code>ï¼›</li> <li><code>getPoolSize</code> - çº¿ç¨‹æ± å½“å‰çš„çº¿ç¨‹æ•°é‡ï¼›</li> <li><code>getActiveCount</code> - å½“å‰çº¿ç¨‹æ± ä¸­æ­£åœ¨æ‰§è¡Œä»»åŠ¡çš„çº¿ç¨‹æ•°é‡ã€‚</li></ul> <h3 id="ä½¿ç”¨ç¤ºä¾‹"><a href="#ä½¿ç”¨ç¤ºä¾‹" class="header-anchor">#</a> ä½¿ç”¨ç¤ºä¾‹</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ThreadPoolExecutorDemo</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ThreadPoolExecutor</span> threadPoolExecutor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">MILLISECONDS</span><span class="token punctuation">,</span>
            <span class="token keyword">new</span> <span class="token class-name">LinkedBlockingQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Runnable</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token class-name">Executors</span><span class="token punctuation">.</span><span class="token function">defaultThreadFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token keyword">new</span> <span class="token class-name">ThreadPoolExecutor<span class="token punctuation">.</span>AbortPolicy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            threadPoolExecutor<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">MyThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> info <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">&quot;çº¿ç¨‹æ± ä¸­çº¿ç¨‹æ•°ç›®ï¼š%sï¼Œé˜Ÿåˆ—ä¸­ç­‰å¾…æ‰§è¡Œçš„ä»»åŠ¡æ•°ç›®ï¼š%sï¼Œå·²æ‰§è¡Œç©åˆ«çš„ä»»åŠ¡æ•°ç›®ï¼š%s&quot;</span><span class="token punctuation">,</span>
                threadPoolExecutor<span class="token punctuation">.</span><span class="token function">getPoolSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                threadPoolExecutor<span class="token punctuation">.</span><span class="token function">getQueue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                threadPoolExecutor<span class="token punctuation">.</span><span class="token function">getCompletedTaskCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>info<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        threadPoolExecutor<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">MyThread</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span> <span class="token punctuation">{</span>

        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; æ‰§è¡Œ&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><h2 id="executors"><a href="#executors" class="header-anchor">#</a> Executors</h2> <p>JDK çš„ <code>Executors</code> ç±»ä¸­æä¾›äº†å‡ ç§å…·æœ‰ä»£è¡¨æ€§çš„çº¿ç¨‹æ± ï¼Œè¿™äº›çº¿ç¨‹æ±  <strong>éƒ½æ˜¯åŸºäº <code>ThreadPoolExecutor</code> çš„å®šåˆ¶åŒ–å®ç°</strong>ã€‚</p> <p>åœ¨å®é™…ä½¿ç”¨çº¿ç¨‹æ± çš„åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬å¾€å¾€ä¸æ˜¯ç›´æ¥ä½¿ç”¨ <code>ThreadPoolExecutor</code> ï¼Œè€Œæ˜¯ä½¿ç”¨ JDK ä¸­æä¾›çš„å…·æœ‰ä»£è¡¨æ€§çš„çº¿ç¨‹æ± å®ä¾‹ã€‚</p> <h3 id="newsinglethreadexecutor"><a href="#newsinglethreadexecutor" class="header-anchor">#</a> newSingleThreadExecutor</h3> <p><strong>åˆ›å»ºä¸€ä¸ªå•çº¿ç¨‹çš„çº¿ç¨‹æ± </strong>ã€‚</p> <p>åªä¼šåˆ›å»ºå”¯ä¸€çš„å·¥ä½œçº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡ï¼Œä¿è¯æ‰€æœ‰ä»»åŠ¡æŒ‰ç…§æŒ‡å®šé¡ºåº(FIFO, LIFO, ä¼˜å…ˆçº§)æ‰§è¡Œã€‚ <strong>å¦‚æœè¿™ä¸ªå”¯ä¸€çš„çº¿ç¨‹å› ä¸ºå¼‚å¸¸ç»“æŸï¼Œé‚£ä¹ˆä¼šæœ‰ä¸€ä¸ªæ–°çš„çº¿ç¨‹æ¥æ›¿ä»£å®ƒ</strong> ã€‚</p> <p>å•å·¥ä½œçº¿ç¨‹æœ€å¤§çš„ç‰¹ç‚¹æ˜¯ï¼š<strong>å¯ä¿è¯é¡ºåºåœ°æ‰§è¡Œå„ä¸ªä»»åŠ¡</strong>ã€‚</p> <p>ç¤ºä¾‹ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SingleThreadExecutorDemo</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ExecutorService</span> executorService <span class="token operator">=</span> <span class="token class-name">Executors</span><span class="token punctuation">.</span><span class="token function">newSingleThreadExecutor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            executorService<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token annotation punctuation">@Override</span>
                <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; æ‰§è¡Œ&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        executorService<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><h3 id="newfixedthreadpool"><a href="#newfixedthreadpool" class="header-anchor">#</a> newFixedThreadPool</h3> <p><strong>åˆ›å»ºä¸€ä¸ªå›ºå®šå¤§å°çš„çº¿ç¨‹æ± </strong>ã€‚</p> <p><strong>æ¯æ¬¡æäº¤ä¸€ä¸ªä»»åŠ¡å°±ä¼šæ–°åˆ›å»ºä¸€ä¸ªå·¥ä½œçº¿ç¨‹ï¼Œå¦‚æœå·¥ä½œçº¿ç¨‹æ•°é‡è¾¾åˆ°çº¿ç¨‹æ± æœ€å¤§çº¿ç¨‹æ•°ï¼Œåˆ™å°†æäº¤çš„ä»»åŠ¡å­˜å…¥åˆ°é˜»å¡é˜Ÿåˆ—ä¸­</strong>ã€‚</p> <p><code>FixedThreadPool</code> æ˜¯ä¸€ä¸ªå…¸å‹ä¸”ä¼˜ç§€çš„çº¿ç¨‹æ± ï¼Œå®ƒå…·æœ‰çº¿ç¨‹æ± æé«˜ç¨‹åºæ•ˆç‡å’ŒèŠ‚çœåˆ›å»ºçº¿ç¨‹æ—¶æ‰€è€—çš„å¼€é”€çš„ä¼˜ç‚¹ã€‚ä½†æ˜¯ï¼Œåœ¨çº¿ç¨‹æ± ç©ºé—²æ—¶ï¼Œå³çº¿ç¨‹æ± ä¸­æ²¡æœ‰å¯è¿è¡Œä»»åŠ¡æ—¶ï¼Œå®ƒä¸ä¼šé‡Šæ”¾å·¥ä½œçº¿ç¨‹ï¼Œè¿˜ä¼šå ç”¨ä¸€å®šçš„ç³»ç»Ÿèµ„æºã€‚</p> <p>ç¤ºä¾‹ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FixedThreadPoolDemo</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ExecutorService</span> executorService <span class="token operator">=</span> <span class="token class-name">Executors</span><span class="token punctuation">.</span><span class="token function">newFixedThreadPool</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            executorService<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token annotation punctuation">@Override</span>
                <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; æ‰§è¡Œ&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        executorService<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><h3 id="newcachedthreadpool"><a href="#newcachedthreadpool" class="header-anchor">#</a> newCachedThreadPool</h3> <p><strong>åˆ›å»ºä¸€ä¸ªå¯ç¼“å­˜çš„çº¿ç¨‹æ± </strong>ã€‚</p> <ul><li>å¦‚æœçº¿ç¨‹æ± å¤§å°è¶…è¿‡å¤„ç†ä»»åŠ¡æ‰€éœ€è¦çš„çº¿ç¨‹æ•°ï¼Œå°±ä¼šå›æ”¶éƒ¨åˆ†ç©ºé—²çš„çº¿ç¨‹ï¼›</li> <li>å¦‚æœé•¿æ—¶é—´æ²¡æœ‰å¾€çº¿ç¨‹æ± ä¸­æäº¤ä»»åŠ¡ï¼Œå³å¦‚æœå·¥ä½œçº¿ç¨‹ç©ºé—²äº†æŒ‡å®šçš„æ—¶é—´ï¼ˆé»˜è®¤ä¸º 1 åˆ†é’Ÿï¼‰ï¼Œåˆ™è¯¥å·¥ä½œçº¿ç¨‹å°†è‡ªåŠ¨ç»ˆæ­¢ã€‚ç»ˆæ­¢åï¼Œå¦‚æœä½ åˆæäº¤äº†æ–°çš„ä»»åŠ¡ï¼Œåˆ™çº¿ç¨‹æ± é‡æ–°åˆ›å»ºä¸€ä¸ªå·¥ä½œçº¿ç¨‹ã€‚</li> <li>æ­¤çº¿ç¨‹æ± ä¸ä¼šå¯¹çº¿ç¨‹æ± å¤§å°åšé™åˆ¶ï¼Œçº¿ç¨‹æ± å¤§å°å®Œå…¨ä¾èµ–äºæ“ä½œç³»ç»Ÿï¼ˆæˆ–è€…è¯´ JVMï¼‰èƒ½å¤Ÿåˆ›å»ºçš„æœ€å¤§çº¿ç¨‹å¤§å°ã€‚ å› æ­¤ï¼Œä½¿ç”¨ <code>CachedThreadPool</code> æ—¶ï¼Œä¸€å®šè¦æ³¨æ„æ§åˆ¶ä»»åŠ¡çš„æ•°é‡ï¼Œå¦åˆ™ï¼Œç”±äºå¤§é‡çº¿ç¨‹åŒæ—¶è¿è¡Œï¼Œå¾ˆæœ‰ä¼šé€ æˆç³»ç»Ÿç˜«ç—ªã€‚</li></ul> <p>ç¤ºä¾‹ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CachedThreadPoolDemo</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ExecutorService</span> executorService <span class="token operator">=</span> <span class="token class-name">Executors</span><span class="token punctuation">.</span><span class="token function">newCachedThreadPool</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            executorService<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token annotation punctuation">@Override</span>
                <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; æ‰§è¡Œ&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        executorService<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><h3 id="newschedulethreadpool"><a href="#newschedulethreadpool" class="header-anchor">#</a> newScheduleThreadPool</h3> <p>åˆ›å»ºä¸€ä¸ªå¤§å°æ— é™çš„çº¿ç¨‹æ± ã€‚æ­¤çº¿ç¨‹æ± æ”¯æŒå®šæ—¶ä»¥åŠå‘¨æœŸæ€§æ‰§è¡Œä»»åŠ¡çš„éœ€æ±‚ã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ScheduledThreadPoolDemo</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">schedule</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">scheduleAtFixedRate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">schedule</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ScheduledExecutorService</span> executorService <span class="token operator">=</span> <span class="token class-name">Executors</span><span class="token punctuation">.</span><span class="token function">newScheduledThreadPool</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            executorService<span class="token punctuation">.</span><span class="token function">schedule</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token annotation punctuation">@Override</span>
                <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; æ‰§è¡Œ&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">SECONDS</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        executorService<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">scheduleAtFixedRate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ScheduledExecutorService</span> executorService <span class="token operator">=</span> <span class="token class-name">Executors</span><span class="token punctuation">.</span><span class="token function">newScheduledThreadPool</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            executorService<span class="token punctuation">.</span><span class="token function">scheduleAtFixedRate</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token annotation punctuation">@Override</span>
                <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; æ‰§è¡Œ&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">SECONDS</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        executorService<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><h3 id="newworkstealingpool"><a href="#newworkstealingpool" class="header-anchor">#</a> newWorkStealingPool</h3> <p>Java 8 æ‰å¼•å…¥ã€‚</p> <p>å…¶å†…éƒ¨ä¼šæ„å»º <code>ForkJoinPool</code>ï¼Œåˆ©ç”¨ <a href="https://en.wikipedia.org/wiki/Work_stealing" target="_blank" rel="noopener noreferrer">Work-Stealing<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ç®—æ³•ï¼Œå¹¶è¡Œåœ°å¤„ç†ä»»åŠ¡ï¼Œä¸ä¿è¯å¤„ç†é¡ºåºã€‚</p> <h2 id="çº¿ç¨‹æ± æœ€ä½³å®è·µ"><a href="#çº¿ç¨‹æ± æœ€ä½³å®è·µ" class="header-anchor">#</a> çº¿ç¨‹æ± æœ€ä½³å®è·µ</h2> <h3 id="è®¡ç®—çº¿ç¨‹æ•°é‡"><a href="#è®¡ç®—çº¿ç¨‹æ•°é‡" class="header-anchor">#</a> è®¡ç®—çº¿ç¨‹æ•°é‡</h3> <p>ä¸€èˆ¬å¤šçº¿ç¨‹æ‰§è¡Œçš„ä»»åŠ¡ç±»å‹å¯ä»¥åˆ†ä¸º CPU å¯†é›†å‹å’Œ I/O å¯†é›†å‹ï¼Œæ ¹æ®ä¸åŒçš„ä»»åŠ¡ç±»å‹ï¼Œæˆ‘ä»¬è®¡ç®—çº¿ç¨‹æ•°çš„æ–¹æ³•ä¹Ÿä¸ä¸€æ ·ã€‚</p> <p>**CPU å¯†é›†å‹ä»»åŠ¡ï¼š**è¿™ç§ä»»åŠ¡æ¶ˆè€—çš„ä¸»è¦æ˜¯ CPU èµ„æºï¼Œå¯ä»¥å°†çº¿ç¨‹æ•°è®¾ç½®ä¸º Nï¼ˆCPU æ ¸å¿ƒæ•°ï¼‰+1ï¼Œæ¯” CPU æ ¸å¿ƒæ•°å¤šå‡ºæ¥çš„ä¸€ä¸ªçº¿ç¨‹æ˜¯ä¸ºäº†é˜²æ­¢çº¿ç¨‹å¶å‘çš„ç¼ºé¡µä¸­æ–­ï¼Œæˆ–è€…å…¶å®ƒåŸå› å¯¼è‡´çš„ä»»åŠ¡æš‚åœè€Œå¸¦æ¥çš„å½±å“ã€‚ä¸€æ—¦ä»»åŠ¡æš‚åœï¼ŒCPU å°±ä¼šå¤„äºç©ºé—²çŠ¶æ€ï¼Œè€Œåœ¨è¿™ç§æƒ…å†µä¸‹å¤šå‡ºæ¥çš„ä¸€ä¸ªçº¿ç¨‹å°±å¯ä»¥å……åˆ†åˆ©ç”¨ CPU çš„ç©ºé—²æ—¶é—´ã€‚</p> <p>**I/O å¯†é›†å‹ä»»åŠ¡ï¼š**è¿™ç§ä»»åŠ¡åº”ç”¨èµ·æ¥ï¼Œç³»ç»Ÿä¼šç”¨å¤§éƒ¨åˆ†çš„æ—¶é—´æ¥å¤„ç† I/O äº¤äº’ï¼Œè€Œçº¿ç¨‹åœ¨å¤„ç† I/O çš„æ—¶é—´æ®µå†…ä¸ä¼šå ç”¨ CPU æ¥å¤„ç†ï¼Œè¿™æ—¶å°±å¯ä»¥å°† CPU äº¤å‡ºç»™å…¶å®ƒçº¿ç¨‹ä½¿ç”¨ã€‚å› æ­¤åœ¨ I/O å¯†é›†å‹ä»»åŠ¡çš„åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å¤šé…ç½®ä¸€äº›çº¿ç¨‹ï¼Œå…·ä½“çš„è®¡ç®—æ–¹æ³•æ˜¯ 2Nã€‚</p> <h3 id="å»ºè®®ä½¿ç”¨æœ‰ç•Œé˜»å¡é˜Ÿåˆ—"><a href="#å»ºè®®ä½¿ç”¨æœ‰ç•Œé˜»å¡é˜Ÿåˆ—" class="header-anchor">#</a> å»ºè®®ä½¿ç”¨æœ‰ç•Œé˜»å¡é˜Ÿåˆ—</h3> <p>ä¸å»ºè®®ä½¿ç”¨ <code>Executors</code> çš„æœ€é‡è¦çš„åŸå› æ˜¯ï¼š<code>Executors</code> æä¾›çš„å¾ˆå¤šæ–¹æ³•é»˜è®¤ä½¿ç”¨çš„éƒ½æ˜¯æ— ç•Œçš„ <code>LinkedBlockingQueue</code>ï¼Œé«˜è´Ÿè½½æƒ…å¢ƒä¸‹ï¼Œæ— ç•Œé˜Ÿåˆ—å¾ˆå®¹æ˜“å¯¼è‡´ OOMï¼Œè€Œ OOM ä¼šå¯¼è‡´æ‰€æœ‰è¯·æ±‚éƒ½æ— æ³•å¤„ç†ï¼Œè¿™æ˜¯è‡´å‘½é—®é¢˜ã€‚æ‰€ä»¥<strong>å¼ºçƒˆå»ºè®®ä½¿ç”¨æœ‰ç•Œé˜Ÿåˆ—</strong>ã€‚</p> <p>ã€Šé˜¿é‡Œå·´å·´ Java å¼€å‘æ‰‹å†Œã€‹ä¸­æåˆ°ï¼Œç¦æ­¢ä½¿ç”¨è¿™äº›æ–¹æ³•æ¥åˆ›å»ºçº¿ç¨‹æ± ï¼Œè€Œåº”è¯¥æ‰‹åŠ¨ <code>new ThreadPoolExecutor</code> æ¥åˆ›å»ºçº¿ç¨‹æ± ã€‚åˆ¶è®¢è¿™æ¡è§„åˆ™æ˜¯å› ä¸ºå®¹æ˜“å¯¼è‡´ç”Ÿäº§äº‹æ•…ï¼Œæœ€å…¸å‹çš„å°±æ˜¯ <code>newFixedThreadPool</code> å’Œ <code>newCachedThreadPool</code>ï¼Œå¯èƒ½å› ä¸ºèµ„æºè€—å°½å¯¼è‡´ OOM é—®é¢˜ã€‚</p> <p>ã€ç¤ºä¾‹ã€‘<code>newFixedThreadPool</code> OOM</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">ThreadPoolExecutor</span> threadPool <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">)</span> <span class="token class-name">Executors</span><span class="token punctuation">.</span><span class="token function">newFixedThreadPool</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">printStats</span><span class="token punctuation">(</span>threadPool<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">100000000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	threadPool<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
		<span class="token class-name">String</span> payload <span class="token operator">=</span> <span class="token class-name">IntStream</span><span class="token punctuation">.</span><span class="token function">rangeClosed</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1000000</span><span class="token punctuation">)</span>
			<span class="token punctuation">.</span><span class="token function">mapToObj</span><span class="token punctuation">(</span>__ <span class="token operator">-&gt;</span> <span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span>
			<span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">joining</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token constant">UUID</span><span class="token punctuation">.</span><span class="token function">randomUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">try</span> <span class="token punctuation">{</span>
			<span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">HOURS</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token punctuation">}</span>
		log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

threadPool<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
threadPool<span class="token punctuation">.</span><span class="token function">awaitTermination</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">HOURS</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>newFixedThreadPool</code> ä½¿ç”¨çš„å·¥ä½œé˜Ÿåˆ—æ˜¯ <code>LinkedBlockingQueue</code> ï¼Œè€Œé»˜è®¤æ„é€ æ–¹æ³•çš„ <code>LinkedBlockingQueue</code> æ˜¯ä¸€ä¸ª <code>Integer.MAX_VALUE</code> é•¿åº¦çš„é˜Ÿåˆ—ï¼Œå¯ä»¥è®¤ä¸ºæ˜¯æ— ç•Œçš„ã€‚å¦‚æœä»»åŠ¡è¾ƒå¤šå¹¶ä¸”æ‰§è¡Œè¾ƒæ…¢çš„è¯ï¼Œé˜Ÿåˆ—å¯èƒ½ä¼šå¿«é€Ÿç§¯å‹ï¼Œæ’‘çˆ†å†…å­˜å¯¼è‡´ OOMã€‚</p> <p>ã€ç¤ºä¾‹ã€‘<code>newCachedThreadPool</code> OOM</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">ThreadPoolExecutor</span> threadPool <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">)</span> <span class="token class-name">Executors</span><span class="token punctuation">.</span><span class="token function">newCachedThreadPool</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">printStats</span><span class="token punctuation">(</span>threadPool<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">100000000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	threadPool<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
		<span class="token class-name">String</span> payload <span class="token operator">=</span> <span class="token constant">UUID</span><span class="token punctuation">.</span><span class="token function">randomUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">try</span> <span class="token punctuation">{</span>
			<span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">HOURS</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token punctuation">}</span>
		log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
threadPool<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
threadPool<span class="token punctuation">.</span><span class="token function">awaitTermination</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">HOURS</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>newCachedThreadPool</code> çš„æœ€å¤§çº¿ç¨‹æ•°æ˜¯ <code>Integer.MAX_VALUE</code>ï¼Œå¯ä»¥è®¤ä¸ºæ˜¯æ²¡æœ‰ä¸Šé™çš„ï¼Œè€Œå…¶å·¥ä½œé˜Ÿåˆ— <code>SynchronousQueue</code> æ˜¯ä¸€ä¸ªæ²¡æœ‰å­˜å‚¨ç©ºé—´çš„é˜»å¡é˜Ÿåˆ—ã€‚è¿™æ„å‘³ç€ï¼Œåªè¦æœ‰è¯·æ±‚åˆ°æ¥ï¼Œå°±å¿…é¡»æ‰¾åˆ°ä¸€æ¡å·¥ä½œçº¿ç¨‹æ¥å¤„ç†ï¼Œå¦‚æœå½“å‰æ²¡æœ‰ç©ºé—²çš„çº¿ç¨‹å°±å†åˆ›å»ºä¸€æ¡æ–°çš„ã€‚</p> <p>å¦‚æœå¤§é‡çš„ä»»åŠ¡è¿›æ¥åä¼šåˆ›å»ºå¤§é‡çš„çº¿ç¨‹ã€‚æˆ‘ä»¬çŸ¥é“çº¿ç¨‹æ˜¯éœ€è¦åˆ†é…ä¸€å®šçš„å†…å­˜ç©ºé—´ä½œä¸ºçº¿ç¨‹æ ˆçš„ï¼Œæ¯”å¦‚ 1MBï¼Œå› æ­¤æ— é™åˆ¶åˆ›å»ºçº¿ç¨‹å¿…ç„¶ä¼šå¯¼è‡´ OOMã€‚</p> <h3 id="é‡è¦ä»»åŠ¡åº”è¯¥è‡ªå®šä¹‰æ‹’ç»ç­–ç•¥"><a href="#é‡è¦ä»»åŠ¡åº”è¯¥è‡ªå®šä¹‰æ‹’ç»ç­–ç•¥" class="header-anchor">#</a> é‡è¦ä»»åŠ¡åº”è¯¥è‡ªå®šä¹‰æ‹’ç»ç­–ç•¥</h3> <p>ä½¿ç”¨æœ‰ç•Œé˜Ÿåˆ—ï¼Œå½“ä»»åŠ¡è¿‡å¤šæ—¶ï¼Œçº¿ç¨‹æ± ä¼šè§¦å‘æ‰§è¡Œæ‹’ç»ç­–ç•¥ï¼Œçº¿ç¨‹æ± é»˜è®¤çš„æ‹’ç»ç­–ç•¥ä¼š throw <code>RejectedExecutionException</code> è¿™æ˜¯ä¸ªè¿è¡Œæ—¶å¼‚å¸¸ï¼Œå¯¹äºè¿è¡Œæ—¶å¼‚å¸¸ç¼–è¯‘å™¨å¹¶ä¸å¼ºåˆ¶ <code>catch</code> å®ƒï¼Œæ‰€ä»¥å¼€å‘äººå‘˜å¾ˆå®¹æ˜“å¿½ç•¥ã€‚å› æ­¤<strong>é»˜è®¤æ‹’ç»ç­–ç•¥è¦æ…é‡ä½¿ç”¨</strong>ã€‚å¦‚æœçº¿ç¨‹æ± å¤„ç†çš„ä»»åŠ¡éå¸¸é‡è¦ï¼Œå»ºè®®è‡ªå®šä¹‰è‡ªå·±çš„æ‹’ç»ç­–ç•¥ï¼›å¹¶ä¸”åœ¨å®é™…å·¥ä½œä¸­ï¼Œè‡ªå®šä¹‰çš„æ‹’ç»ç­–ç•¥å¾€å¾€å’Œé™çº§ç­–ç•¥é…åˆä½¿ç”¨ã€‚</p> <h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="header-anchor">#</a> å‚è€ƒèµ„æ–™</h2> <ul><li><a href="https://book.douban.com/subject/10484692/" target="_blank" rel="noopener noreferrer">ã€ŠJava å¹¶å‘ç¼–ç¨‹å®æˆ˜ã€‹<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://book.douban.com/subject/26591326/" target="_blank" rel="noopener noreferrer">ã€ŠJava å¹¶å‘ç¼–ç¨‹çš„è‰ºæœ¯ã€‹<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.jianshu.com/p/d2729853c4da" target="_blank" rel="noopener noreferrer">æ·±å…¥ç†è§£ Java çº¿ç¨‹æ± ï¼šThreadPoolExecutor<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.cnblogs.com/MOBIN/p/5436482.html" target="_blank" rel="noopener noreferrer">java å¹¶å‘ç¼–ç¨‹--Executor æ¡†æ¶<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div>  <div class="page-edit"><div class="edit-link"><a href="https://github.com/dunwu/javacore/edit/master/docs/01.Java/01.JavaSE/05.å¹¶å‘/07.Javaçº¿ç¨‹æ± .md" target="_blank" rel="noopener noreferrer">ğŸ“ å¸®åŠ©æ”¹å–„æ­¤é¡µé¢ï¼</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="tags"><a href="/javacore/tags/?tag=Java" title="æ ‡ç­¾">#Java</a><a href="/javacore/tags/?tag=JavaSE" title="æ ‡ç­¾">#JavaSE</a><a href="/javacore/tags/?tag=%E5%B9%B6%E5%8F%91" title="æ ‡ç­¾">#å¹¶å‘</a><a href="/javacore/tags/?tag=%E7%BA%BF%E7%A8%8B%E6%B1%A0" title="æ ‡ç­¾">#çº¿ç¨‹æ± </a></div> <div class="last-updated"><span class="prefix">ä¸Šæ¬¡æ›´æ–°:</span> <span class="time">2024/09/13, 06:43:21</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/javacore/pages/b067d6/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">Javaå¹¶å‘å’Œå®¹å™¨</div></a> <a href="/javacore/pages/02d274/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">Javaå¹¶å‘å·¥å…·ç±»</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        â†
        <a href="/javacore/pages/b067d6/" class="prev">Javaå¹¶å‘å’Œå®¹å™¨</a></span> <span class="next"><a href="/javacore/pages/02d274/">Javaå¹¶å‘å·¥å…·ç±»</a>â†’
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/javacore/archives/" class="iconfont icon-bi">æœ€è¿‘æ›´æ–°</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/javacore/pages/69d2f8/"><div>
            JavaSE
            <!----></div></a> <span class="date">05-06</span></dt></dl><dl><dd>02</dd> <dt><a href="/javacore/pages/496a7e/"><div>
            æºç çº§æ·±åº¦ç†è§£ Java SPI
            <!----></div></a> <span class="date">04-26</span></dt></dl><dl><dd>03</dd> <dt><a href="/javacore/pages/2950ba/"><div>
            Java åŸºç¡€è¯­æ³•ç‰¹æ€§
            <!----></div></a> <span class="date">01-25</span></dt></dl> <dl><dd></dd> <dt><a href="/javacore/archives/" class="more">æ›´å¤šæ–‡ç« &gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:forbreak@163.com" title="å‘é‚®ä»¶" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/dunwu" title="GitHub" target="_blank" class="iconfont icon-github"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="æœ¬ç«™ä¸»é¢˜">Vdoing</a> 
    | Copyright Â© 2019-2024
    <span>é’æ‚Ÿï¼ˆdunwuï¼‰ | CC-BY-SA-4.0</span></div> <div class="buttons"><div title="è¿”å›é¡¶éƒ¨" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="å»è¯„è®º" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="ä¸»é¢˜æ¨¡å¼" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          è·Ÿéšç³»ç»Ÿ
        </li><li class="iconfont icon-rijianmoshi">
          æµ…è‰²æ¨¡å¼
        </li><li class="iconfont icon-yejianmoshi">
          æ·±è‰²æ¨¡å¼
        </li><li class="iconfont icon-yuedu">
          é˜…è¯»æ¨¡å¼
        </li></ul></div></div> <!----> <!----> <div class="custom-html-window custom-html-window-rb" style="display:;"><div class="custom-wrapper"><span class="close-but">Ã—</span> <div>
    <div class="wwads-cn wwads-vertical windowRB" data-id="261" style="max-width:160px;
    min-width: auto;min-height:auto;"></div>
    <style>
      .windowRB{ padding: 0;}
      .windowRB .wwads-img{margin-top: 10px;}
      .windowRB .wwads-content{margin: 0 10px 40px 10px;}
      .custom-html-window-rb .close-but{
        display: none;
      }
    </style>
  </div></div></div></div><div class="global-ui"><div></div></div></div>
    <script src="/javacore/assets/js/app.44fc03ae.js" defer></script><script src="/javacore/assets/js/2.aded268b.js" defer></script><script src="/javacore/assets/js/46.68ab70d3.js" defer></script>
  </body>
</html>
