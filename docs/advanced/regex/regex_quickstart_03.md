# 导读

**正则表达式是什么？有什么用？**
***正则表达式(Regular Expression)***是一种文本规则，可以用来**校验**、**查找**、**替换**与规则匹配的文本。

**又爱又恨的正则**

正则表达式是一个强大的文本匹配工具，但是它的规则实在很繁琐，而且理解起来也颇为蛋疼，容易让人望而生畏。

**如何学习正则**

刚接触正则时，我看了一堆正则的语义说明，但是仍然不明所以。后来，我多接触一些正则的应用实例，渐渐有了感觉，再结合语义说明，终有领悟。我觉得正则表达式和武侠修练武功差不多，应该先练招式，再练心法。如果一开始就直接看正则的规则，保证你会懵逼。
当你熟悉基本招式（正则基本使用案例）后，也该修炼修炼心法（正则语法）了。真正的高手不能只靠死记硬背那么几招把式。就像张三丰教张无忌太极拳一样，领悟心法，融会贯通，少侠你就可以无招胜有招，成为传说中的绝世高手。

**以上闲话可归纳为一句：学习正则应该从实例去理解规则。**

![欲练神功，必先自宫](http://upload-images.jianshu.io/upload_images/3101171-e6b876043b7ba083.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)
打开秘籍：欲练神功，必先自宫！没有蛋，也就不会蛋疼了。

**Java正则速成秘籍分三篇：**

- ***[Java正则速成秘籍（一）之招式篇](http://www.cnblogs.com/jingmoxukong/p/6026474.html)***

展示Java对于正则表达式的支持。

- [***Java正则速成秘籍（二）之心法篇***](http://www.cnblogs.com/jingmoxukong/p/6030197.html)

介绍正则表达式的语法规则。

- [***Java正则速成秘籍（三）之见招拆招篇***](http://www.cnblogs.com/jingmoxukong/p/6040572.html)

从实战出发，介绍正则的常用案例。




> 本文是Java正则速成秘籍的最后一篇——见招拆招篇。
>
> 在 [Java正则速成秘籍（一）之招式篇](http://www.cnblogs.com/jingmoxukong/p/6026474.html) 和 [Java正则速成秘籍（二）之心法篇](http://www.cnblogs.com/jingmoxukong/p/6030197.html)，我们学习了Java支持正则功能的API以及正则表达式的语法。
>
> 本文则主要展示正则表达式在现实场景的应用。文中不会再提及正则的语法以及Java正则相关的API，如有疑问，可以参考前面两篇文章。
>
> **注：本文展示的案例，已经经过我的充分测试。**如果你有兴趣，可以参考 [***我的github单元测试源码***](https://github.com/atlantis1024/JavaSENotes/blob/master/src/test/java/org/zp/notes/javase/regex/RegexUtilTest.java) 。
>



# 正则应用

虽然本系列洋洋洒洒的大谈特谈正则表达式。但是我还是要在这里建议，如果一个正则表达式没有经过充分测试，还是要谨慎使用。

正则是把双刃剑，它可以为你节省大量的代码行。但是由于它不易阅读，维护起来可是头疼的哦（你需要一个字符一个字符的去理解）。



## 最实用的正则

### 校验中文

**描述：**校验字符串中只能有中文字符（不包括中文标点符号）。中文字符的Unicode编码范围是\u4e00 到 \u9fa5。

如有兴趣，可以参考[***百度百科-Unicode***](http://baike.baidu.com/link?url=3xi0vmvCIGKQLJZdn_BYhQ1IDFsoSJMrya6_eOjCBb7A6cRIW-zhZFLC9Yh8wjxU6A_HCfNuP8FBBXU9CN3Wcq) 。

```
^[\u4e00-\u9fa5]+$
```

**匹配：** 春眠不觉晓

**不匹配：**春眠不觉晓，



### 校验身份证号码

**描述：**身份证为15位或18位。15位是第一代身份证。从1999年10月1日起，全国实行公民身份证号码制度，居民身份证编号由原15位升至18位。

**15位身份证**

**描述：**由15位数字组成。排列顺序从左至右依次为：六位数字地区码；六位数字出生日期；三位顺序号，其中15位男为单数，女为双数。

**18位身份证**

**描述：**由十七位数字本体码和一位数字校验码组成。排列顺序从左至右依次为：六位数字地区码；八位数字出生日期；三位数字顺序码和一位数字校验码（也可能是X）。

身份证号含义详情请见：[***百度百科-居民身份证号码***](http://baike.baidu.com/link?url=5mYlYNE0RsSe2D4tydajtiaR8hAm4pPZ0FHSPuQ05N4f6H-i7qPuw7sY5KfNuiOVJWVWZvU4gf3IY-vIcKdP1CU4Fv-9pKmFQB50qGv_hZT2dkGbkd9--8_saY7omV80vEw9ixVeEwda37fHswfmtyU4QSiBG5s3K5K-JnYr1dqNlPu0f3t008UcLh5-wyID)

**地区码（6位）**

```
(1[1-5]|2[1-3]|3[1-7]|4[1-3]|5[0-4]|6[1-5])\d{4}
```

**出生日期（8位）**

注：下面的是18位身份证的有效出生日期，如果是15位身份证，只要将第一个\d{4}改为\d{2}即可。

```
((\d{4}((0[13578]|1[02])(0[1-9]|[12]\d|3[01])|(0[13456789]|1[012])(0[1-9]|[12]\d|30)|02(0[1-9]|1\d|2[0-8])))|([02468][048]|[13579][26])0229)
```



**15位有效身份证**

```
^((1[1-5]|2[1-3]|3[1-7]|4[1-3]|5[0-4]|6[1-5])\d{4})((\d{2}((0[13578]|1[02])(0[1-9]|[12]\d|3[01])|(0[13456789]|1[012])(0[1-9]|[12]\d|30)|02(0[1-9]|1\d|2[0-8])))|([02468][048]|[13579][26])0229)(\d{3})$
```

**匹配：**110001700101031

**不匹配：**110001701501031



**18位有效身份证**

```
^((1[1-5]|2[1-3]|3[1-7]|4[1-3]|5[0-4]|6[1-5])\d{4})((\d{4}((0[13578]|1[02])(0[1-9]|[12]\d|3[01])|(0[13456789]|1[012])(0[1-9]|[12]\d|30)|02(0[1-9]|1\d|2[0-8])))|([02468][048]|[13579][26])0229)(\d{3}(\d|X))$
```

**匹配：**110001199001010310 | 11000019900101015X

**不匹配：**990000199001010310 | 110001199013010310



### 校验有效用户名、密码

**描述：**长度为6-18个字符，允许输入字母、数字、下划线，首字符必须为字母。

```
^[a-zA-Z]\w{5,17}$
```

**匹配：**he_llo@worl.d.com | hel.l-o@wor-ld.museum | h1ello@123.com

**不匹配：**hello@worl_d.com | he&llo@world.co1 | .hello@wor#.co.uk



### 校验邮箱

**描述：**不允许使用IP作为域名，如 : hello@154.145.68.12

 `@`符号前的邮箱用户和`.`符号前的域名(domain)必须满足以下条件：

- 字符只能是英文字母、数字、下划线`_`、`.`、`-` ；
- 首字符必须为字母或数字；
- `_`、`.`、`-` 不能连续出现。

域名的根域只能为字母，且至少为两个字符。

```
^[A-Za-z0-9](([_\.\-]?[a-zA-Z0-9]+)*)@([A-Za-z0-9]+)(([\.\-]?[a-zA-Z0-9]+)*)\.([A-Za-z]{2,})$
```

**匹配：**he_llo@worl.d.com | hel.l-o@wor-ld.museum | h1ello@123.com

**不匹配：**hello@worl_d.com | he&llo@world.co1 | .hello@wor#.co.uk



### 校验URL

**描述：**校验URL。支持http、https、ftp、ftps。

```
^(ht|f)(tp|tps)\://[a-zA-Z0-9\-\.]+\.([a-zA-Z]{2,3})?(/\S*)?$
```

**匹配：**http://google.com/help/me | http://www.google.com/help/me/ | https://www.google.com/help.asp | ftp://www.google.com | ftps://google.org

**不匹配：**http://un/www.google.com/index.asp



### 校验时间

**描述：**校验时间。时、分、秒必须是有效数字，如果数值不是两位数，十位需要补零。

```
^([0-1][0-9]|[2][0-3]):([0-5][0-9])$
```

**匹配：**00:00:00 | 23:59:59 | 17:06:30

**不匹配：**17:6:30 | 24:16:30



### 校验日期

**描述：**校验日期。日期满足以下条件：

- 格式yyyy-MM-dd或yyyy-M-d
- 连字符可以没有或是“-”、“/”、“.”之一
- 闰年的二月可以有29日；而平年不可以。
- 一、三、五、七、八、十、十二月为31日。四、六、九、十一月为30日。


```
^(?:(?!0000)[0-9]{4}([-/.]?)(?:(?:0?[1-9]|1[0-2])\1(?:0?[1-9]|1[0-9]|2[0-8])|(?:0?[13-9]|1[0-2])\1(?:29|30)|(?:0?[13578]|1[02])\1(?:31))|(?:[0-9]{2}(?:0[48]|[2468][048]|[13579][26])|(?:0[48]|[2468][048]|[13579][26])00)([-/.]?)0?2\2(?:29))$
```

**匹配：**2016/1/1 | 2016/01/01 | 20160101 | 2016-01-01 | 2016.01.01 | 2000-02-29

**不匹配：**2001-02-29 | 2016/12/32 | 2016/6/31 |  2016/13/1 | 2016/0/1



### 校验中国手机号码

**描述：**中国手机号码正确格式：11位数字。

移动有16个号段：134、135、136、137、138、139、147、150、151、152、157、158、159、182、187、188。其中147、157、188是3G号段，其他都是2G号段。
联通有7种号段：130、131、132、155、156、185、186。其中186是3G（WCDMA）号段，其余为2G号段。
电信有4个号段：133、153、180、189。其中189是3G号段（CDMA2000），133号段主要用作无线网卡号。
总结：13开头手机号0-9；15开头手机号0-3、5-9；18开头手机号0、2、5-9。

此外，中国在国际上的区号为86，所以手机号开头有+86、86也是合法的。

以上信息来源于 [***百度百科-手机号***](http://baike.baidu.com/link?url=Bia2K_f8rGcakOlP4d9m_-DNSgXU5-0NDP0pPavS0ZbhRHQcUFUTbMERjdO4u7cvkpTJaIDeUXq_EXWnMqXMdSuMQDX3NAbZXAlZYl_V18KATWF7y1EFzUyJ62rf3bAN)

```
^((\+)?86\s*)?((13[0-9])|(15([0-3]|[5-9]))|(18[0,2,5-9]))\d{8}$
```

**匹配：**+86 18012345678 | 86 18012345678 | 15812345678

**不匹配：**15412345678 | 12912345678 | 180123456789



### 校验中国固话号码

**描述：**固话号码，必须加区号（以0开头）。
3位有效区号：010、020~029，固话位数为8位。
4位有效区号：03xx开头到09xx，固话位数为7。

如果想了解更详细的信息，请参考 [***百度百科-电话区号***](http://baike.baidu.com/link?url=sX8JoxK1ja5uM5pDYvQe27_QsyqAZ_78DLSeEvwjqtG_uXqU6p5Oh7CPbImNbnwu1ClOmD8udgDIswZfYzQIw0z3BYZO3eTplvVDzieuowTYqt7yHGDAqyT7o4vvGhg4) 。

```
^(010|02[0-9])(\s|-)\d{8}|(0[3-9]\d{2})(\s|-)\d{7}$
```

**匹配：**010-12345678 | 010 12345678 | 0512-1234567 | 0512 1234567

**不匹配：**1234567 | 12345678



### 校验IPv4地址

**描述：**IP地址是一个32位的二进制数，通常被分割为4个“8位二进制数”（也就是4个字节）。IP地址通常用“点分十进制”表示成（a.b.c.d）的形式，其中，a,b,c,d都是0~255之间的十进制整数。

```
^([01]?\d\d?|2[0-4]\d|25[0-5])\.([01]?\d\d?|2[0-4]\d|25[0-5])\.([01]?\d\d?|2[0-4]\d|25[0-5])\.([01]?\d\d?|2[0-4]\d|25[0-5])$
```

**匹配：**0.0.0.0 | 255.255.255.255 | 127.0.0.1

**不匹配：**10.10.10 | 10.10.10.256



### 校验IPv6地址

**描述：**IPv6的128位地址通常写成8组，每组为四个十六进制数的形式。

IPv6地址可以表示为以下形式：

- IPv6 地址
- 零压缩 IPv6 地址([section 2.2 of rfc5952](https://tools.ietf.org/html/rfc5952#section-2.2))
- 带有本地链接区域索引的 IPv6 地址 ([section 11 of rfc4007](https://tools.ietf.org/html/rfc4007#section-11))
- 嵌入IPv4的 IPv6 地址([section 2 of rfc6052](https://tools.ietf.org/html/rfc6052#section-2)
- 映射IPv4的 IPv6 地址 ([section 2.1 of rfc2765](https://tools.ietf.org/html/rfc2765#section-2.1))
- 翻译IPv4的 IPv6 地址 ([section 2.1 of rfc2765](https://tools.ietf.org/html/rfc2765#section-2.1))

显然，IPv6地址的表示方式很复杂。你也可以参考 

[***百度百科-IPv6***](http://baike.baidu.com/link?url=D3nmh0q_G_ZVmxXFG79mjjNfT4hs9fwjqUgygh-tvhq43KYqx88HV27WEXmoT4nA4iGzXwXMm5L-j50C2gSL5q) 

[***Stack overflow上的IPv6正则表达高票答案***](http://stackoverflow.com/questions/53497/regular-expression-that-matches-valid-ipv6-addresses)

```
(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))
```

**匹配：**1:2:3:4:5:6:7:8 | 1:: | 1::8 | 1::6:7:8 | 1::5:6:7:8 | 1::4:5:6:7:8 | 1::3:4:5:6:7:8 | ::2:3:4:5:6:7:8 | 1:2:3:4:5:6:7:: | 1:2:3:4:5:6::8 | 1:2:3:4:5::8 | 1:2:3:4::8 | 1:2:3::8 | 1:2::8 | 1::8 | ::8 | fe80::7:8%1 | ::255.255.255.255 | 2001:db8:3:4::192.0.2.33 | 64:ff9b::192.0.2.33

**不匹配：**1.2.3.4.5.6.7.8 | 1::2::3



## 特定字符

匹配长度为3的字符串：`^.{3}$`。

匹配由26个英文字母组成的字符串：`^[A-Za-z]+$`。

匹配由26个大写英文字母组成的字符串：`^[A-Z]+$`。

匹配由26个小写英文字母组成的字符串：`^[a-z]+$`。

匹配由数字和26个英文字母组成的字符串：`^[A-Za-z0-9]+$`。

匹配由数字、26个英文字母或者下划线组成的字符串：`^\w+$`。




## 特定数字

匹配正整数：`^[1-9]\d*$`

匹配负整数：`^-[1-9]\d*$`

匹配整数：`^(-?[1-9]\d*)|0$`

匹配正浮点数：`^[1-9]\d*\.\d+|0\.\d+$`

匹配负浮点数：`^-([1-9]\d*\.\d*|0\.\d*[1-9]\d*)$`

匹配浮点数：`^-?([1-9]\d*\.\d*|0\.\d*[1-9]\d*|0?\.0+|0)$`



# 参考

[正则应用之——日期正则表达式](http://blog.csdn.net/lxcnn/article/details/4362500)

[http://www.regexlib.com/](http://www.regexlib.com/)